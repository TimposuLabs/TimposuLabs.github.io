"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[9337],{28453(e,n,t){t.d(n,{R:()=>i,x:()=>d});var a=t(96540);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}},85657(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"springboot/springboot-jpa-hibernate/one-to-many-update","title":"One-to-Many Update","description":"Hibernate","source":"@site/tutorial/spring/springboot/springboot-jpa-hibernate/19-one-to-many-update.md","sourceDirName":"springboot/springboot-jpa-hibernate","slug":"/springboot/springboot-jpa-hibernate/one-to-many-update","permalink":"/spring/springboot/springboot-jpa-hibernate/one-to-many-update","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":19,"frontMatter":{"sidebar_position":19,"title":"One-to-Many Update"},"sidebar":"tutorialSidebar","previous":{"title":"One-to-Many Lazy Fetch","permalink":"/spring/springboot/springboot-jpa-hibernate/one-to-many-lazy"},"next":{"title":"One-to-Many Delete","permalink":"/spring/springboot/springboot-jpa-hibernate/one-to-many-delete"}}');var s=t(74848),r=t(28453);const i={sidebar_position:19,title:"One-to-Many Update"},d=void 0,l={},c=[{value:"1\ufe0f\u20e3 Entity Parrent: <code>Classes.java</code>",id:"1\ufe0f\u20e3-entity-parrent-classesjava",level:2},{value:"2\ufe0f\u20e3 Entity Child: <code>Student.java</code>",id:"2\ufe0f\u20e3-entity-child-studentjava",level:2},{value:"3\ufe0f\u20e3 Update Parrent <code>Classes</code>",id:"3\ufe0f\u20e3-update-parrent-classes",level:2},{value:"\ud83d\udee2\ufe0f Repository / DAO",id:"\ufe0f-repository--dao",level:3},{value:"\u25b6\ufe0f Main Class",id:"\ufe0f-main-class",level:3},{value:"4\ufe0f\u20e3 Update Child <code>Student</code>",id:"4\ufe0f\u20e3-update-child-student",level:2},{value:"\ud83d\udee2\ufe0f Repository / DAO",id:"\ufe0f-repository--dao-1",level:3},{value:"\u25b6\ufe0f Main Class",id:"\ufe0f-main-class-1",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Hibernate",src:t(89053).A+"",width:"782",height:"310"})}),"\n",(0,s.jsxs)(n.p,{children:["Operasi ",(0,s.jsx)(n.em,{children:"update"})," pada kasus relasi ",(0,s.jsx)(n.code,{children:"Classes"})," dan ",(0,s.jsx)(n.code,{children:"Student"}),", akan menggunakan methode ",(0,s.jsx)(n.code,{children:"merge()"})," dan mekanisme ",(0,s.jsx)(n.em,{children:"Dirty Checking"})," otomatis yang memungkinkan pembaruan data secara efisien tanpa harus menulis query SQL manual, sekaligus memastikan perubahan tersinkronisasi secara dua arah (",(0,s.jsx)(n.em,{children:"bi-directional"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:["Pembahasan materi update ini akan dibahas dari sisi parrent(",(0,s.jsx)(n.code,{children:"Classes"}),") dan update dari sisi child(",(0,s.jsx)(n.code,{children:"Student"}),")."]}),"\n",(0,s.jsxs)(n.h2,{id:"1\ufe0f\u20e3-entity-parrent-classesjava",children:["1\ufe0f\u20e3 Entity Parrent: ",(0,s.jsx)(n.code,{children:"Classes.java"})]}),"\n",(0,s.jsxs)(n.p,{children:["Ubah fetch type menjadi ",(0,s.jsx)(n.strong,{children:"Lazy"})," ",(0,s.jsx)(n.code,{children:"fetch = FetchType.LAZY"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Entity\r\n@Table(name = "classes")\r\npublic class Classes {\r\n\r\n\t@Id\r\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\tprivate Integer id;\r\n\t\r\n\t@Column(name = "class_name")\r\n\tprivate String className;\r\n\t\r\n\t@OneToOne(cascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\t@JoinColumn(name = "teacher_id")\r\n\tprivate Teacher teacher;\r\n\t\r\n\t@OneToMany(\r\n\t\tmappedBy = "classes",\r\n\t\tfetch = FetchType.LAZY,\r\n\t\tcascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\tList<Student> students = new ArrayList<>();\r\n\r\n\t// Setter & Getter\r\n\r\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"2\ufe0f\u20e3-entity-child-studentjava",children:["2\ufe0f\u20e3 Entity Child: ",(0,s.jsx)(n.code,{children:"Student.java"})]}),"\n",(0,s.jsxs)(n.p,{children:["Sisi ",(0,s.jsx)(n.code,{children:"@ManyToOne"})," secara default bersifat ",(0,s.jsx)(n.strong,{children:"EAGER"}),", pada kasus ini kita tidak perlu mengubahnya kecuali kita ingin menjadikannya ",(0,s.jsx)(n.strong,{children:"LAZY"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Entity\r\n@Table(name = "student")\r\npublic class Student {\r\n\r\n\t@Id\r\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\tprivate Integer id;\r\n\t\r\n\t@Column(name = "first_name")\r\n\tprivate String firstName;\r\n\t\r\n\t@Column(name = "last_name")\r\n\tprivate String lastName;\r\n\t\r\n\t@ManyToOne(cascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\t@JoinColumn(name = "class_id")\r\n\tprivate Classes classes;\r\n\t\r\n\t// Setter & Getter\r\n\r\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"3\ufe0f\u20e3-update-parrent-classes",children:["3\ufe0f\u20e3 Update Parrent ",(0,s.jsx)(n.code,{children:"Classes"})]}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-repository--dao",children:"\ud83d\udee2\ufe0f Repository / DAO"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Menambahkan method baru pada interface DAO dengan menambahkan method ",(0,s.jsx)(n.code,{children:"updateClasses(Classes classes)"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public interface SchoolDAO {\r\n\r\n\tvoid saveClasses(Classes classes);\r\n\t\r\n\tClasses findClassById(Integer id);\r\n\t\r\n\tvoid deleteClassesById(Integer id);\r\n\t\r\n\tTeacher findTeacherById(Integer id);\r\n\t\r\n\tvoid deleteTeacherById(Integer id);\r\n\t\r\n\tList<Student> findStudentByClassId(Integer id);\r\n\t\r\n\tClasses findClassesByIdJoinFetch(Integer id);\r\n\t\r\n\tvoid updateClasses(Classes classes);\r\n\t\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implementasi DAO:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Repository\r\npublic class SchoolDAOImpl implements SchoolDAO {\r\n\r\n\tprivate EntityManager entityManager;\r\n\t\r\n\tpublic SchoolDAOImpl(EntityManager entityManager) {\r\n\t\tthis.entityManager = entityManager;\r\n\t}\r\n\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void updateClasses(Classes classes) {\r\n\t\tentityManager.merge(classes);\t\r\n\t}\r\n\r\n\t// Implementasi method Lainnya\r\n\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-main-class",children:"\u25b6\ufe0f Main Class"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Pada main class application kita akan mengubah data ",(0,s.jsx)(n.code,{children:"Classes"})," yang memiliki id 3:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@SpringBootApplication\r\npublic class Application {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(Application.class, args);\r\n\t}\r\n\r\n\t// Bean ini akan dieksekusi di command line\r\n\t@Bean\r\n\tpublic CommandLineRunner commandLineRunner(SchoolDAO dao) {\r\n\t\treturn runner -> {\r\n\t\t\t\r\n\t\t\tupdateClasses(dao);\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\r\n\tprivate void updateClasses(SchoolDAO dao) {\r\n\t\tint id = 3;\r\n\t\t\r\n\t\tClasses classes = dao.findClassesByIdJoinFetch(id);\r\n\t\tclasses.setClassName("Kelas 12");\r\n\t\tdao.updateClasses(classes);\t\t\r\n\t}\r\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Output pada Hibernate SQL:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"Hibernate: select c1_0.id,c1_0.class_name,s1_0.class_id,s1_0.id,s1_0.first_name,s1_0.last_name,t1_0.id,t1_0.first_name,t1_0.last_name from classes c1_0 join student s1_0 on c1_0.id=s1_0.class_id join teacher t1_0 on t1_0.id=c1_0.teacher_id where c1_0.id=?\r\nHibernate: select c1_0.id,c1_0.class_name,t1_0.id,t1_0.first_name,t1_0.last_name,s1_0.class_id,s1_0.id,s1_0.first_name,s1_0.last_name from classes c1_0 left join teacher t1_0 on t1_0.id=c1_0.teacher_id left join student s1_0 on c1_0.id=s1_0.class_id where c1_0.id=?\r\nHibernate: update classes set class_name=?,teacher_id=? where id=?\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cek perubahan dalam database dengan id 3."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"mysql> select * from classes;\r\n\r\n+----+------------+------------+\r\n| id | class_name | teacher_id |\r\n+----+------------+------------+\r\n|  3 | Kelas 12   |          2 |\r\n+----+------------+------------+\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"4\ufe0f\u20e3-update-child-student",children:["4\ufe0f\u20e3 Update Child ",(0,s.jsx)(n.code,{children:"Student"})]}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-repository--dao-1",children:"\ud83d\udee2\ufe0f Repository / DAO"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Menambahkan method baru pada interface DAO dengan menambahkan method ",(0,s.jsx)(n.code,{children:"findStudentById(Integer id)"})," dan ",(0,s.jsx)(n.code,{children:"updateStudent(Student student)"})," untuk menghandle update data ",(0,s.jsx)(n.code,{children:"Student"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public interface SchoolDAO {\r\n\r\n\tvoid saveClasses(Classes classes);\r\n\t\r\n\tClasses findClassById(Integer id);\r\n\t\r\n\tvoid deleteClassesById(Integer id);\r\n\t\r\n\tTeacher findTeacherById(Integer id);\r\n\t\r\n\tvoid deleteTeacherById(Integer id);\r\n\t\r\n\tList<Student> findStudentByClassId(Integer id);\r\n\t\r\n\tClasses findClassesByIdJoinFetch(Integer id);\r\n\t\r\n\tvoid updateClasses(Classes classes);\r\n\r\n\tStudent findStudentById(Integer id);\r\n\t\r\n\tvoid updateStudent(Student student);\r\n\t\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implementasi DAO:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Repository\r\npublic class SchoolDAOImpl implements SchoolDAO {\r\n\r\n\tprivate EntityManager entityManager;\r\n\t\r\n\tpublic SchoolDAOImpl(EntityManager entityManager) {\r\n\t\tthis.entityManager = entityManager;\r\n\t}\r\n\r\n\t// handle update data Classes\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void updateClasses(Classes classes) {\r\n\t\tentityManager.merge(classes);\t\r\n\t}\r\n\r\n\t// handle update data Student\r\n\t@Override\r\n\t@Transactional(readOnly = true)\r\n\tpublic Student findStudentById(Integer id) {\r\n\t\treturn entityManager.find(Student.class, id);\r\n\t}\r\n\t\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void updateStudent(Student student) {\r\n\t\tentityManager.merge(student);\r\n\t}\r\n\r\n\t// Implementasi method Lainnya\r\n\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-main-class-1",children:"\u25b6\ufe0f Main Class"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Pada main class application kita akan mengubah data ",(0,s.jsx)(n.code,{children:"Student"})," yang memiliki id 9:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@SpringBootApplication\r\npublic class Application {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(Application.class, args);\r\n\t}\r\n\r\n\t// Bean ini akan dieksekusi di command line\r\n\t@Bean\r\n\tpublic CommandLineRunner commandLineRunner(SchoolDAO dao) {\r\n\t\treturn runner -> {\r\n\t\t\t\r\n\t\t\tupdateStudent(dao);\r\n\r\n\t\t};\r\n\t}\r\n\r\n\tprivate void updateStudent(SchoolDAO dao) {\r\n\t\tint id = 9;\r\n\t\t\r\n\t\tStudent student = dao.findStudentById(id);\r\n\t\tstudent.setFirstName("Rock");\r\n\t\tstudent.setLastName("Lee");\r\n\t\tdao.updateStudent(student);\r\n\t}\r\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Output pada Hibernate SQL:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"Hibernate: select s1_0.id,c1_0.id,c1_0.class_name,t1_0.id,t1_0.first_name,t1_0.last_name,s1_0.first_name,s1_0.last_name from student s1_0 left join classes c1_0 on c1_0.id=s1_0.class_id left join teacher t1_0 on t1_0.id=c1_0.teacher_id where s1_0.id=?\r\nHibernate: select s1_0.id,c1_0.id,c1_0.class_name,t1_0.id,t1_0.first_name,t1_0.last_name,s1_0.first_name,s1_0.last_name from student s1_0 left join classes c1_0 on c1_0.id=s1_0.class_id left join teacher t1_0 on t1_0.id=c1_0.teacher_id where s1_0.id=?\r\nHibernate: select s1_0.class_id,s1_0.id,s1_0.first_name,s1_0.last_name from student s1_0 where s1_0.class_id=?\r\nHibernate: update student set class_id=?,first_name=?,last_name=? where id=?\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Cek perubahan dalam database, dalam tabel ",(0,s.jsx)(n.code,{children:"Student"})," data dengan id 9 sudah berubah."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"mysql> select * from student;\r\n+----+------------+-----------+----------+\r\n| id | first_name | last_name | class_id |\r\n+----+------------+-----------+----------+\r\n|  7 | Uzumaki    | Naruto    |        3 |\r\n|  8 | Uciha      | Sazuke    |        3 |\r\n|  9 | Rock       | Lee       |        3 |\r\n+----+------------+-----------+----------+\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Source Code"}),": ",(0,s.jsx)(n.a,{href:"https://github.com/TimposuLabs/belajar-springboot-jpa-hibernate-advance/tree/main/08-hibernate-one-to-many-update",children:"https://github.com/TimposuLabs/belajar-springboot-jpa-hibernate-advance/tree/main/08-hibernate-one-to-many-update"})]})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},89053(e,n,t){t.d(n,{A:()=>a});const a=t.p+"assets/images/one-to-many2-00fb2d0cbe6ed69f3fb5b85aae37a8e9.png"}}]);