"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[63197],{28453(e,n,a){a.d(n,{R:()=>l,x:()=>d});var i=a(96540);const s={},r=i.createContext(s);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:n},e.children)}},71620(e,n,a){a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"docker-image-advance/instruksi-run","title":"Dockerfile RUN","description":"1\ufe0f\u20e3 Apa itu Dockerfile RUN?","source":"@site/tutorial/docker/07-docker-image-advance/05-instruksi-run.md","sourceDirName":"07-docker-image-advance","slug":"/docker-image-advance/instruksi-run","permalink":"/docker/docker-image-advance/instruksi-run","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Dockerfile RUN"},"sidebar":"tutorialSidebar","previous":{"title":"Dockerfile CMD","permalink":"/docker/docker-image-advance/instruksi-cmd"},"next":{"title":"Dockerfile COPY","permalink":"/docker/docker-image-advance/instruksi-copy"}}');var s=a(74848),r=a(28453);const l={sidebar_position:5,title:"Dockerfile RUN"},d=void 0,c={},t=[{value:"1\ufe0f\u20e3 Apa itu Dockerfile <code>RUN</code>?",id:"1\ufe0f\u20e3-apa-itu-dockerfile-run",level:2},{value:"2\ufe0f\u20e3 Format Penulisan (Syntax)",id:"2\ufe0f\u20e3-format-penulisan-syntax",level:2},{value:"A. Shell Form (Paling Sering Digunakan)",id:"a-shell-form-paling-sering-digunakan",level:3},{value:"B. Exec Form",id:"b-exec-form",level:3},{value:"3\ufe0f\u20e3 Best Practice &amp; Optimasi",id:"3\ufe0f\u20e3-best-practice--optimasi",level:2},{value:"A. Menggabungkan Perintah (Chaining)",id:"a-menggabungkan-perintah-chaining",level:3},{value:"B. Membersihkan Sampah (Cleaning Up)",id:"b-membersihkan-sampah-cleaning-up",level:3},{value:"C. Pemanfaatan Cache",id:"c-pemanfaatan-cache",level:3}];function o(e){const n={code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h2,{id:"1\ufe0f\u20e3-apa-itu-dockerfile-run",children:["1\ufe0f\u20e3 Apa itu Dockerfile ",(0,s.jsx)(n.code,{children:"RUN"}),"?"]}),"\n",(0,s.jsxs)(n.p,{children:["Instruksi ",(0,s.jsx)(n.code,{children:"RUN"})," hampir sama dengan instruksi ",(0,s.jsx)(n.code,{children:"CMD"}),", cuma perbedaannya jika instruksi ",(0,s.jsx)(n.code,{children:"CMD"})," perintah di dalamnya dieksekusi ketika ",(0,s.jsx)(n.strong,{children:"container dijalankan"}),", instruksi ",(0,s.jsx)(n.code,{children:"RUN"})," dijalankan ketika ",(0,s.jsx)(n.strong,{children:"hanya proses build berjalan"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Perbedaan berikutnya instruksi ",(0,s.jsx)(n.code,{children:"CMD"})," digunakan untuk menjalankan atau mendefinisikan proses default atau proses utama ketika container dijalankan, konsekuensinya di dalam dockerfile ",(0,s.jsxs)(n.strong,{children:["tidak boleh lebih dari satu instruksi ",(0,s.jsx)(n.code,{children:"CMD"})]}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Hal tersebut tidak berlaku pada instruksi ",(0,s.jsx)(n.code,{children:"RUN"})," kita dapat mendefinisikan ",(0,s.jsx)(n.strong,{children:"lebih dari satu"})," instruksi ",(0,s.jsx)(n.code,{children:"RUN"}),", namun yang perlu diperhatikan setiap satu instruksi ",(0,s.jsx)(n.code,{children:"RUN"})," ",(0,s.jsx)(n.strong,{children:"akan menammbahkan satu layer"})," dalam suatu image, sehingga diusahakan menggunakan instruksi ",(0,s.jsx)(n.code,{children:"RUN"})," seefisien mungkin."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tujuan Utama"}),": Menginstal paket software, membuat folder, mengubah izin file (",(0,s.jsx)(n.code,{children:"chmod"}),"), atau mengunduh dependensi aplikasi."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Kapan dijalankan?"})," Hanya saat kita menjalankan perintah ",(0,s.jsx)(n.code,{children:"docker build"}),". Hasil dari perintah ",(0,s.jsx)(n.code,{children:"RUN"})," akan disimpan secara permanen di dalam image."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"2\ufe0f\u20e3-format-penulisan-syntax",children:"2\ufe0f\u20e3 Format Penulisan (Syntax)"}),"\n",(0,s.jsx)(n.p,{children:"Terdapat dua cara penulisan:"}),"\n",(0,s.jsx)(n.h3,{id:"a-shell-form-paling-sering-digunakan",children:"A. Shell Form (Paling Sering Digunakan)"}),"\n",(0,s.jsx)(n.p,{children:"Ditulis seperti mengetik perintah di terminal Linux biasa."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Contoh 1:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"RUN apt-get update && apt-get install openjdk-21-jre-headless -y\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Contoh 2:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"RUN apk add --no-cache curl\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Contoh 3:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'ARG ubuntu_version=22.04\nFROM ubuntu:${ubuntu_version}\nLABEL version="1.0"\nLABEL maintainer="Ucup Topekox" email="ucup@gmail.com" environtment="development"\nENV DATABASE_NAME=book_store\nRUN apt-get update && apt-get install openjdk-21-jre-headless -y\n\nCMD ["/usr/bin/java", "--version"]\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Kelebihan"}),": Sangat mudah dibaca dan mendukung penggunaan variabel lingkungan serta simbol shell seperti ",(0,s.jsx)(n.code,{children:"&&"}),", ",(0,s.jsx)(n.code,{children:"||"}),", dan ",(0,s.jsx)(n.code,{children:">"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"b-exec-form",children:"B. Exec Form"}),"\n",(0,s.jsx)(n.p,{children:"Menggunakan format JSON (kurung siku)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'RUN ["apk", "add", "--no-cache", "curl"]\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Kegunaan"}),": Digunakan jika base image tidak memiliki shell (",(0,s.jsx)(n.code,{children:"/bin/sh"}),") atau untuk menghindari pemrosesan string oleh shell."]}),"\n",(0,s.jsx)(n.h2,{id:"3\ufe0f\u20e3-best-practice--optimasi",children:"3\ufe0f\u20e3 Best Practice & Optimasi"}),"\n",(0,s.jsxs)(n.p,{children:["Dalam menggunakan ",(0,s.jsx)(n.code,{children:"RUN"})," perlu memperhatikan efisiensi layer:"]}),"\n",(0,s.jsx)(n.h3,{id:"a-menggabungkan-perintah-chaining",children:"A. Menggabungkan Perintah (Chaining)"}),"\n",(0,s.jsxs)(n.p,{children:["Jangan membuat banyak layer untuk hal yang berkaitan. Gunakan ",(0,s.jsx)(n.code,{children:"&&"})," dan ",(0,s.jsx)(n.code,{children:"\\"})," (backslash)."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Buruk \u274c (Menciptakan 3 Layer)"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"RUN apk update\nRUN apk add curl\nRUN apk add git\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Baik \u2705 (Menciptakan 1 Layer)"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"RUN apk update && apk add --no-cache \\\ncurl \\\ngit\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"b-membersihkan-sampah-cleaning-up",children:"B. Membersihkan Sampah (Cleaning Up)"}),"\n",(0,s.jsxs)(n.p,{children:["Disarankan untuk menghapus cache atau file sementara dalam satu perintah ",(0,s.jsx)(n.code,{children:"RUN"})," yang sama agar ukuran image tetap kecil."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"RUN apk add --no-cache build-base && \\\n    make /app && \\\n    apk del build-base\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["Dengan cara ini, tool kompilasi ",(0,s.jsx)(n.code,{children:"build-base"})," tidak akan ikut tersimpan di image akhir."]})}),"\n",(0,s.jsx)(n.h3,{id:"c-pemanfaatan-cache",children:"C. Pemanfaatan Cache"}),"\n",(0,s.jsxs)(n.p,{children:["Docker tidak akan menjalankan ulang instruksi ",(0,s.jsx)(n.code,{children:"RUN"})," jika baris tersebut dan file yang terkait tidak berubah sejak build sebelumnya. Contoh ketika menggunakan Java, pada framework Spring Boot kita menaruh instalasi dependensi (seperti ",(0,s.jsx)(n.code,{children:"mvn dependency:go-offline"}),"), maka Apache Maven mengunduh semua dependensi (library), plugin, dan file POM yang dibutuhkan oleh project dari internet ke repositori lokal (folder ",(0,s.jsx)(n.code,{children:".m2"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:['Tujuan utamanya adalah agar bisa melakukan kompilasi atau membangun aplikasi nantinya tanpa membutuhkan koneksi internet sama sekali ("',(0,s.jsx)(n.strong,{children:"Go Offline"}),'").']})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);