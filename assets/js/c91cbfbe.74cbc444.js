"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[31248],{28453(e,n,a){a.d(n,{R:()=>d,x:()=>t});var s=a(96540);const i={},l=s.createContext(i);function d(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(l.Provider,{value:n},e.children)}},58242(e,n,a){a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>u,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"express/file-upload","title":"Upload File","description":"Sebelumnya kita belum membahas bagaimana jika Request Body yang dikirim adalah File Upload atau Multipart Form Data. Secara default Express.js, tidak menyediakan fitur untuk mengakses Unggah Berkas File. Namun, kita dapat memanfaatkan Middleware pihak ketiga untuk mengakses Upload File.","source":"@site/tutorial/nodejs/express/21-file-upload.md","sourceDirName":"express","slug":"/express/file-upload","permalink":"/nodejs/express/file-upload","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":21,"frontMatter":{"sidebar_position":21,"title":"Upload File"},"sidebar":"tutorialSidebar","previous":{"title":"Template Engine","permalink":"/nodejs/express/template-engine"},"next":{"title":"Not Found Handling","permalink":"/nodejs/express/not-found-handling"}}');var i=a(74848),l=a(28453);const d={sidebar_position:21,title:"Upload File"},t=void 0,r={},o=[{value:"\u2b06\ufe0f Express Fileupload",id:"\ufe0f-express-fileupload",level:2},{value:"\u2699\ufe0f Install Express Fileupload",id:"\ufe0f-install-express-fileupload",level:3},{value:"\u2705 Menggunakan Express Fileupload",id:"-menggunakan-express-fileupload",level:3},{value:"\ud83d\udd25 Fullcode dengan Unit Test",id:"-fullcode-dengan-unit-test",level:3}];function p(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Sebelumnya kita belum membahas bagaimana jika Request Body yang dikirim adalah ",(0,i.jsx)(n.em,{children:"File Upload"})," atau ",(0,i.jsx)(n.em,{children:"Multipart Form Data"}),". Secara default Express.js, tidak menyediakan fitur untuk mengakses Unggah Berkas File. Namun, kita dapat memanfaatkan Middleware pihak ketiga untuk mengakses Upload File."]}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-express-fileupload",children:"\u2b06\ufe0f Express Fileupload"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"express-fileupload"})," adalah sebuah middleware sederhana untuk framework Express.js yang dirancang untuk menangani unggahan berkas (file upload)."]}),"\n",(0,i.jsxs)(n.p,{children:["Berikut function yang disediakan ",(0,i.jsx)(n.code,{children:"express-fileupload"}),":"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Function"}),(0,i.jsx)(n.th,{children:"Keterangan"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.name"})}),(0,i.jsx)(n.td,{children:'mengembalikan nama file contoh "car.jpg"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.mv"})}),(0,i.jsx)(n.td,{children:"Fungsi untuk memindahkan file ke tempat lain di server Anda. Dapat menerima callback atau return a promise."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.mimetype"})}),(0,i.jsx)(n.td,{children:"Jenis file mimetype"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.data"})}),(0,i.jsxs)(n.td,{children:["Representasi buffer file Anda, mengembalikan buffer kosong jika opsi ",(0,i.jsx)(n.code,{children:"useTempFiles"})," diatur ke ",(0,i.jsx)(n.code,{children:"true"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.tempFilePath"})}),(0,i.jsxs)(n.td,{children:["Path file sementara jika opsi ",(0,i.jsx)(n.code,{children:"useTempFiles"})," diatur ke true."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.truncated"})}),(0,i.jsx)(n.td,{children:"Nilai boolean yang mewakili jika file melebihi batas ukuran"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.size"})}),(0,i.jsxs)(n.td,{children:["Ukuran file yang diupload dalam ",(0,i.jsx)(n.em,{children:"bytes"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"req.files.foo.md5"})}),(0,i.jsx)(n.td,{children:"MD5 checksum file yang diupload"})]})]})]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/richardgirges/express-fileupload#readme",children:"https://github.com/richardgirges/express-fileupload#readme"})}),"\n"]})}),"\n",(0,i.jsx)(n.h3,{id:"\ufe0f-install-express-fileupload",children:"\u2699\ufe0f Install Express Fileupload"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"npm i express-fileupload\n"})}),"\n",(0,i.jsx)(n.h3,{id:"-menggunakan-express-fileupload",children:"\u2705 Menggunakan Express Fileupload"}),"\n",(0,i.jsxs)(n.p,{children:["Buat folder ",(0,i.jsx)(n.code,{children:"upload"}),", untuk menyimpan lokasi file yang akan diupload:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"mkdir upload\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Menggunakan ",(0,i.jsx)(n.code,{children:"express-fileupload"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const express = require('express');\nconst fileUpload = require('express-fileupload');\n\nconst app = express();\napp.use(express.json()); // menambahkan middleware untuk parsing JSON\napp.use(express.urlencoded({ extended: false })); // menambahkan middleware untuk parsing form data dengan extended: false, yang berarti hanya mendukung tipe data sederhana\napp.use(fileUpload()); // menambahkan middleware untuk handling file upload \n\napp.post('/file-upload', async (req, res) => {\n    const textFile = req.files.textFile;\n    await textFile.mv(__dirname + \"/upload/\" + textFile.name);\n\n    res.send(`Hello ${req.body.name} File ${textFile.name} uploaded!`);\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"-fullcode-dengan-unit-test",children:"\ud83d\udd25 Fullcode dengan Unit Test"}),"\n",(0,i.jsx)(n.p,{children:"Berikut contoh kode di atas dengan unit test:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const request = require('supertest');\nconst express = require('express');\nconst fileUpload = require('express-fileupload');\n\nconst app = express();\napp.use(express.json()); // menambahkan middleware untuk parsing JSON\napp.use(express.urlencoded({ extended: false })); // menambahkan middleware untuk parsing form data dengan extended: false, yang berarti hanya mendukung tipe data sederhana\napp.use(fileUpload()); // menambahkan middleware untuk handling file upload \n\napp.post('/file-upload', async (req, res) => {\n    const textFile = req.files.textFile;\n    await textFile.mv(__dirname + \"/upload/\" + textFile.name);\n\n    res.send(`Hello ${req.body.name} File ${textFile.name} uploaded!`);\n});\n\n// Unit Test\ntest('Test Request File Upload /file-upload endpoint', async () => {\n    const response = await request(app)\n        .post('/file-upload')\n        .set('Content-Type', 'multipart/form-data')\n        .field('name', 'Ucup')\n        .attach('textFile', __dirname + '/hello.txt');\n\n    expect(response.text).toBe('Hello Ucup File hello.txt uploaded!');\n});\n"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);