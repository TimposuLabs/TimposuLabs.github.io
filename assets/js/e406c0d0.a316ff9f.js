"use strict";(self.webpackChunktimposu=self.webpackChunktimposu||[]).push([[45027],{8140:(a,e,n)=>{n.r(e),n.d(e,{assets:()=>t,contentTitle:()=>d,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"docker-image-advance/docker-image-layer","title":"Docker Image Layer","description":"Docker Image dibangun dari beberapa layer yang masing-masing layer tersebut bersifat read only. Masing-masing layer menumpuk satu sama lain, yang kemudian menjadi satu entitas Image. Dengan konsep layering memungkinkan docker meng-caching (cacheable) layer tersebut yang nantinya dapat digunakan kembali (reusable) pada image yang berbeda. Hal ini akan mempercepat proses build dan menghemat penyimpanan pada sistem komputer kita.","source":"@site/tutorial/docker/07-docker-image-advance/01-docker-image-layer.md","sourceDirName":"07-docker-image-advance","slug":"/docker-image-advance/docker-image-layer","permalink":"/docker/docker-image-advance/docker-image-layer","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Docker Image Layer"},"sidebar":"tutorialSidebar","previous":{"title":"Docker Image - Advance","permalink":"/docker/docker-image-advance/"},"next":{"title":"Dockerfile FROM & LABEL","permalink":"/docker/docker-image-advance/instruksi-from-label"}}');var r=n(74848),s=n(28453);const l={sidebar_position:1,title:"Docker Image Layer"},d=void 0,t={},c=[{value:"1\ufe0f\u20e3 Konsep &quot;Stack of Layers&quot;",id:"1\ufe0f\u20e3-konsep-stack-of-layers",level:2},{value:"2\ufe0f\u20e3 Mengapa Harus Berlapis? (Efisiensi)",id:"2\ufe0f\u20e3-mengapa-harus-berlapis-efisiensi",level:2},{value:"A. Reusability (Penggunaan Kembali)",id:"a-reusability-penggunaan-kembali",level:3},{value:"B. Layer Caching (Proses Build Cepat)",id:"b-layer-caching-proses-build-cepat",level:3},{value:"3\ufe0f\u20e3 Jenis-Jenis Layer",id:"3\ufe0f\u20e3-jenis-jenis-layer",level:2},{value:"4\ufe0f\u20e3 Contoh Layering",id:"4\ufe0f\u20e3-contoh-layering",level:2},{value:"Contoh saat melakukan pull image",id:"contoh-saat-melakukan-pull-image",level:3},{value:"Contoh pada Dockerfile",id:"contoh-pada-dockerfile",level:3},{value:"5\ufe0f\u20e3 Melihat Layer dalam Image dengan Docker History",id:"5\ufe0f\u20e3-melihat-layer-dalam-image-dengan-docker-history",level:2},{value:"6\ufe0f\u20e3 Docker Image Inspect",id:"6\ufe0f\u20e3-docker-image-inspect",level:2},{value:"Cara Penggunaan",id:"cara-penggunaan",level:3},{value:"Membaca Informasi Spesifik (Filtering)",id:"membaca-informasi-spesifik-filtering",level:3},{value:"7\ufe0f\u20e3 Tips Optimasi Layer",id:"7\ufe0f\u20e3-tips-optimasi-layer",level:2}];function o(a){const e={code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...a.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"Docker Image dibangun dari beberapa layer yang masing-masing layer tersebut bersifat read only. Masing-masing layer menumpuk satu sama lain, yang kemudian menjadi satu entitas Image. Dengan konsep layering memungkinkan docker meng-caching (cacheable) layer tersebut yang nantinya dapat digunakan kembali (reusable) pada image yang berbeda. Hal ini akan mempercepat proses build dan menghemat penyimpanan pada sistem komputer kita."}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"https://camo.githubusercontent.com/4456216228dd413ad92492ae42d54e1e54b9868380011f3593c1fb0748496332/68747470733a2f2f6d69726f2e6d656469756d2e636f6d2f76322f726573697a653a6669743a313430302f302a486f78415a545a3262324337414d2d2d",alt:"Docker Image Layer"})}),"\n",(0,r.jsx)(e.h2,{id:"1\ufe0f\u20e3-konsep-stack-of-layers",children:'1\ufe0f\u20e3 Konsep "Stack of Layers"'}),"\n",(0,r.jsx)(e.p,{children:"Bayangkan sebuah Image sebagai sebuah kue lapis:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Setiap instruksi di Dockerfile (seperti ",(0,r.jsx)(e.code,{children:"FROM"}),", ",(0,r.jsx)(e.code,{children:"RUN"}),", ",(0,r.jsx)(e.code,{children:"COPY"}),") menambah satu lapisan pada kue tersebut."]}),"\n",(0,r.jsxs)(e.li,{children:["Lapisan paling bawah adalah ",(0,r.jsx)(e.strong,{children:"Base Image"})," (misal: Alpine atau Ubuntu)."]}),"\n",(0,r.jsxs)(e.li,{children:["Setiap lapisan bersifat ",(0,r.jsx)(e.strong,{children:"Read-Only"})," (Hanya-Baca) dan tidak bisa diubah setelah dibuat."]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"2\ufe0f\u20e3-mengapa-harus-berlapis-efisiensi",children:"2\ufe0f\u20e3 Mengapa Harus Berlapis? (Efisiensi)"}),"\n",(0,r.jsx)(e.p,{children:"Ada dua keuntungan besar dari sistem layering ini:"}),"\n",(0,r.jsx)(e.h3,{id:"a-reusability-penggunaan-kembali",children:"A. Reusability (Penggunaan Kembali)"}),"\n",(0,r.jsxs)(e.p,{children:["Jika kita memiliki 5 aplikasi berbeda yang semuanya menggunakan ",(0,r.jsx)(e.code,{children:"FROM alpine:3.21"}),", Docker hanya akan menyimpan ",(0,r.jsx)(e.strong,{children:"satu salinan"})," layer Alpine tersebut di harddisk kita. Kelima image tersebut akan berbagi layer yang sama."]}),"\n",(0,r.jsx)(e.h3,{id:"b-layer-caching-proses-build-cepat",children:"B. Layer Caching (Proses Build Cepat)"}),"\n",(0,r.jsx)(e.p,{children:"Saat kita mengubah kode aplikasi dan melakukan build ulang:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Docker akan memeriksa setiap instruksi Dockerfile dari atas ke bawah."}),"\n",(0,r.jsxs)(e.li,{children:["Jika instruksi dan file yang disalin tidak berubah, Docker akan mengambil hasil dari ",(0,r.jsx)(e.strong,{children:"Cache"})," (tanpa memproses ulang)."]}),"\n",(0,r.jsx)(e.li,{children:'Proses build hanya akan benar-benar "bekerja" mulai dari baris yang kita ubah ke bawah.'}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"3\ufe0f\u20e3-jenis-jenis-layer",children:"3\ufe0f\u20e3 Jenis-Jenis Layer"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Image Layers (Read-Only)"}),": Semua lapisan/layer yang dihasilkan saat proses docker build. Layer ini bersifat permanen di dalam image."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Container Layer (Read-Write)"}),": Saat kita menjalankan kontainer (",(0,r.jsx)(e.code,{children:"docker run"}),"), Docker menambahkan satu layer tipis di paling atas yang bisa ditulisi.","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Semua perubahan yang Anda lakukan saat kontainer berjalan (menambah file, mengedit teks) disimpan di sini."}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Penting"}),": Saat kontainer dihapus, lapisan Read-Write ini ikut hilang, itulah sebabnya kita butuh ",(0,r.jsx)(e.strong,{children:"Volumes"})," untuk data permanen."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"4\ufe0f\u20e3-contoh-layering",children:"4\ufe0f\u20e3 Contoh Layering"}),"\n",(0,r.jsx)(e.h3,{id:"contoh-saat-melakukan-pull-image",children:"Contoh saat melakukan pull image"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"docker image pull nginx:latest\n\nlatest: Pulling from library/nginx\n6e909acdb790: Already exists \n5eaa34f5b9c2: Pull complete \n417c4bccf534: Pull complete \ne7e0ca015e55: Pull complete \n373fe654e984: Pull complete \n97f5c0f51d43: Pull complete \nc22eb46e871a: Pull complete \nDigest: sha256:124b44bfc9ccd1f3cedf4b592d4d1e8bddb78b51ec2ed5056c52d3692baebc19\nStatus: Downloaded newer image for nginx:latest\ndocker.io/library/nginx:latest\n"})}),"\n",(0,r.jsx)(e.p,{children:"Kalau kita perhatikan docker mendownload beberapa layer kemudian membuat image."}),"\n",(0,r.jsx)(e.h3,{id:"contoh-pada-dockerfile",children:"Contoh pada Dockerfile"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-dockerfile",children:'FROM alpine:3.21                    # Layer 1: OS Dasar (~5MB)\nRUN apk add --no-cache python3      # Layer 2: Instalasi Python (+~40MB)\nCOPY app.py /app/                   # Layer 3: Kode Aplikasi (Hanya beberapa KB)\nCMD ["python3", "/app/app.py"]      # Layer 4: Metadata perintah jalan\n'})}),"\n",(0,r.jsx)(e.h2,{id:"5\ufe0f\u20e3-melihat-layer-dalam-image-dengan-docker-history",children:"5\ufe0f\u20e3 Melihat Layer dalam Image dengan Docker History"}),"\n",(0,r.jsx)(e.p,{children:"Kita bisa mengintip layer-layer yang membentuk sebuah image menggunakan perintah:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"docker image history <nama_image>\n"})}),"\n",(0,r.jsx)(e.p,{children:"Kita akan melihat daftar instruksi, ukuran setiap layer, dan ID uniknya."}),"\n",(0,r.jsx)(e.h2,{id:"6\ufe0f\u20e3-docker-image-inspect",children:"6\ufe0f\u20e3 Docker Image Inspect"}),"\n",(0,r.jsxs)(e.p,{children:["Docker Image Inspect digunakan untuk mengambil informasi sangat detail dari sebuah image dalam format ",(0,r.jsx)(e.strong,{children:"JSON"}),". Jika ",(0,r.jsx)(e.code,{children:"docker image ls"})," hanya menampilkan nama dan ukuran, ",(0,r.jsx)(e.code,{children:"inspect"})," menampilkan konfigurasi sistem, variabel lingkungan, hingga daftar layer yang membentuk image tersebut."]}),"\n",(0,r.jsx)(e.p,{children:"Kita bisa menggunakan Docker Image Inspect untuk membedah image (terutama image buatan orang lain) guna mengetahui:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Env Variables"}),": Apa saja variabel lingkungan (",(0,r.jsx)(e.code,{children:"ENV"}),") yang dibutuhkan aplikasi."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Exposed Ports"}),": Port berapa yang harus dibuka agar aplikasi bisa diakses."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Layers"}),": Bagaimana struktur lapisan image tersebut dibuat."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Architecture"}),": Apakah image ini untuk chip Intel (x86) atau Apple/ARM."]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Entrypoint/CMD"}),": Perintah apa yang akan otomatis dijalankan saat kontainer menyala."]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"cara-penggunaan",children:"Cara Penggunaan"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Sintaks Dasar:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"docker image inspect <nama/id_image>\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Contoh:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"docker image inspect nginx:stable-bullseye\n"})}),"\n",(0,r.jsx)(e.h3,{id:"membaca-informasi-spesifik-filtering",children:"Membaca Informasi Spesifik (Filtering)"}),"\n",(0,r.jsxs)(e.p,{children:["Karena output-nya sangat panjang, Anda bisa menggunakan flag ",(0,r.jsx)(e.code,{children:"--format"})," untuk mengambil data tertentu saja:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Melihat Perintah Default (",(0,r.jsx)(e.code,{children:"CMD"}),"):"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"docker image inspect --format='{{.Config.Cmd}}' nginx\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Melihat Variabel Lingkungan (",(0,r.jsx)(e.code,{children:"ENV"}),"):"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"docker image inspect --format='{{.Config.Env}}' mysql\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Melihat Ukuran Image secara Detail:"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"docker image inspect --format='{{.Size}}' alpine\n"})}),"\n",(0,r.jsx)(e.h2,{id:"7\ufe0f\u20e3-tips-optimasi-layer",children:"7\ufe0f\u20e3 Tips Optimasi Layer"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsxs)(e.strong,{children:["Gabungkan Perintah ",(0,r.jsx)(e.code,{children:"RUN"})]}),": Setiap perintah ",(0,r.jsx)(e.code,{children:"RUN"})," membuat layer. Gunakan ",(0,r.jsx)(e.code,{children:"&&"})," untuk menggabungkan banyak perintah agar jumlah layer lebih sedikit dan ukuran image lebih ramping.","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Buruk \u274c"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-dockerfile",children:"RUN apk update\nRUN apk add curl\n"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Baik \u2705"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-dockerfile",children:"RUN apk update && apk add curl\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Letakkan yang Jarang Berubah di Atas"}),": Selalu letakkan ",(0,r.jsx)(e.code,{children:"FROM"})," dan instalasi library/dependensi di atas. Letakkan ",(0,r.jsx)(e.code,{children:"COPY . ."})," (kode sumber) di bagian bawah karena kode paling sering berubah dan akan membatalkan cache untuk baris-baris di bawahnya."]}),"\n"]})]})}function m(a={}){const{wrapper:e}={...(0,s.R)(),...a.components};return e?(0,r.jsx)(e,{...a,children:(0,r.jsx)(o,{...a})}):o(a)}},28453:(a,e,n)=>{n.d(e,{R:()=>l,x:()=>d});var i=n(96540);const r={},s=i.createContext(r);function l(a){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof a?a(e):{...e,...a}}),[e,a])}function d(a){let e;return e=a.disableParentContext?"function"==typeof a.components?a.components(r):a.components||r:l(a.components),i.createElement(s.Provider,{value:e},a.children)}}}]);