"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[93693],{28453(e,a,n){n.d(a,{R:()=>t,x:()=>l});var i=n(96540);const r={},s=i.createContext(r);function t(e){const a=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(s.Provider,{value:a},e.children)}},35414(e,a,n){n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>l,default:()=>o,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"docker-image-advance/instruksi-user","title":"Dockerfile USER","description":"\ud83e\udd14 Apa itu Instruksi Dockerfile USER?","source":"@site/tutorial/docker/07-docker-image-advance/10-instruksi-user.md","sourceDirName":"07-docker-image-advance","slug":"/docker-image-advance/instruksi-user","permalink":"/docker/docker-image-advance/instruksi-user","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"title":"Dockerfile USER"},"sidebar":"tutorialSidebar","previous":{"title":"Dockerfile ENTRYPOINT","permalink":"/docker/docker-image-advance/instruksi-entrypoint"},"next":{"title":"Dockerfile EXPOSE","permalink":"/docker/docker-image-advance/instruksi-expose"}}');var r=n(74848),s=n(28453);const t={sidebar_position:10,title:"Dockerfile USER"},l=void 0,d={},c=[{value:"\ud83e\udd14 Apa itu Instruksi Dockerfile <code>USER</code>?",id:"-apa-itu-instruksi-dockerfile-user",level:2},{value:"1\ufe0f\u20e3 Mengapa Sangat Penting? (Security First)",id:"1\ufe0f\u20e3-mengapa-sangat-penting-security-first",level:2},{value:"2\ufe0f\u20e3 Alur Kerja Implementasi (Best Practice)",id:"2\ufe0f\u20e3-alur-kerja-implementasi-best-practice",level:2},{value:"A. Di Alpine Linux (Minimalis)",id:"a-di-alpine-linux-minimalis",level:3},{value:"B. Di UBI / Debian (Enterprise)",id:"b-di-ubi--debian-enterprise",level:3},{value:"3\ufe0f\u20e3 Memahami <code>--chown</code> pada <code>COPY</code>",id:"3\ufe0f\u20e3-memahami---chown-pada-copy",level:2},{value:"4\ufe0f\u20e3 Cara Mengecek User yang Aktif",id:"4\ufe0f\u20e3-cara-mengecek-user-yang-aktif",level:2},{value:"5\ufe0f\u20e3 Tips",id:"5\ufe0f\u20e3-tips",level:2}];function u(e){const a={code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.h2,{id:"-apa-itu-instruksi-dockerfile-user",children:["\ud83e\udd14 Apa itu Instruksi Dockerfile ",(0,r.jsx)(a.code,{children:"USER"}),"?"]}),"\n",(0,r.jsxs)(a.p,{children:["Secara default, Docker menjalankan semua proses di dalam kontainer sebagai ",(0,r.jsx)(a.strong,{children:"root"})," (administrator). Instruksi ",(0,r.jsx)(a.code,{children:"USER"})," digunakan untuk mengubah identitas pengguna (UID) atau grup (GID) yang menjalankan aplikasi."]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Fungsi"}),": Mengalihkan hak akses dari ",(0,r.jsx)(a.em,{children:"Superuser"})," (root) ke N",(0,r.jsx)(a.em,{children:"ormal User"}),"."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Efek"}),": Semua instruksi ",(0,r.jsx)(a.code,{children:"RUN"}),", ",(0,r.jsx)(a.code,{children:"CMD"}),", dan ",(0,r.jsx)(a.code,{children:"ENTRYPOINT"})," yang berada di bawahnya akan dijalankan menggunakan identitas user tersebut."]}),"\n"]}),"\n",(0,r.jsx)(a.h2,{id:"1\ufe0f\u20e3-mengapa-sangat-penting-security-first",children:"1\ufe0f\u20e3 Mengapa Sangat Penting? (Security First)"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Mencegah Escalation"}),": Jika aplikasi (misal: Java API) diretas, penyerang hanya akan memiliki hak akses terbatas sesuai user yang Anda buat. Mereka tidak bisa mengubah file sistem, menginstal paket software, atau merusak Kernel host."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Kepatuhan (Compliance)"}),": Standar industri seperti PCI-DSS, SOC2, dan orkestrator seperti ",(0,r.jsx)(a.strong,{children:"Kubernetes"})," sering kali melarang kontainer berjalan sebagai root."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Manajemen File"}),": Membantu sinkronisasi izin akses file antara komputer host dan kontainer saat menggunakan ",(0,r.jsx)(a.em,{children:"Volumes"}),"."]}),"\n"]}),"\n",(0,r.jsx)(a.h2,{id:"2\ufe0f\u20e3-alur-kerja-implementasi-best-practice",children:"2\ufe0f\u20e3 Alur Kerja Implementasi (Best Practice)"}),"\n",(0,r.jsxs)(a.p,{children:["Kita tidak bisa langsung menulis ",(0,r.jsx)(a.code,{children:"USER ucup"})," jika user tersebut belum dibuat di dalam sistem operasi image. Berikut adalah alur standar:"]}),"\n",(0,r.jsx)(a.h3,{id:"a-di-alpine-linux-minimalis",children:"A. Di Alpine Linux (Minimalis)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-dockerfile",children:'# 1. Buat grup dan user (-S untuk system user, -D untuk tanpa password)\r\nRUN addgroup -S ucupgroup && adduser -S ucup -G ucupgroup\r\n\r\n# 2. Atur folder kerja dan izin akses (SAAT MASIH ROOT)\r\nWORKDIR /app\r\nCOPY --chown=ucup:ucupgroup . .\r\n\r\n# 3. Pindah ke user non-root\r\nUSER ucup\r\n\r\n# Sekarang CMD berjalan sebagai ucup\r\nCMD ["java", "-jar", "app.jar"]\n'})}),"\n",(0,r.jsx)(a.h3,{id:"b-di-ubi--debian-enterprise",children:"B. Di UBI / Debian (Enterprise)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-dockerfile",children:"# Menggunakan useradd (biasanya butuh instalasi shadow-utils di UBI-minimal)\r\nRUN groupadd -r ucupgroup && useradd -r -g ucupgroup ucup\r\nUSER ucup\n"})}),"\n",(0,r.jsxs)(a.h2,{id:"3\ufe0f\u20e3-memahami---chown-pada-copy",children:["3\ufe0f\u20e3 Memahami ",(0,r.jsx)(a.code,{children:"--chown"})," pada ",(0,r.jsx)(a.code,{children:"COPY"})]}),"\n",(0,r.jsxs)(a.p,{children:["Saat menggunakan ",(0,r.jsx)(a.code,{children:"USER"}),", file yang disalin melalui ",(0,r.jsx)(a.code,{children:"COPY"})," tetap akan dimiliki oleh root kecuali menggunakan flag ",(0,r.jsx)(a.code,{children:"--chown"}),"."]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Wajib"}),": ",(0,r.jsx)(a.code,{children:"COPY --chown=ucup:ucupgroup . ."})]}),"\n",(0,r.jsxs)(a.li,{children:["Tanpa ini, user ",(0,r.jsx)(a.code,{children:"ucup"})," tidak akan bisa membaca atau menulis file aplikasinya sendiri."]}),"\n"]}),"\n",(0,r.jsx)(a.h2,{id:"4\ufe0f\u20e3-cara-mengecek-user-yang-aktif",children:"4\ufe0f\u20e3 Cara Mengecek User yang Aktif"}),"\n",(0,r.jsx)(a.p,{children:"Kita bisa memastikan siapa yang menjalankan kontainer dengan perintah:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker exec [NAMA_KONTAINER] whoami\r\n# Hasilnya harus 'ucup', bukan 'root'\n"})}),"\n",(0,r.jsx)(a.p,{children:"Atau melalui inspect:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker inspect --format='{{.Config.User}}' [NAMA_IMAGE]\n"})}),"\n",(0,r.jsx)(a.h2,{id:"5\ufe0f\u20e3-tips",children:"5\ufe0f\u20e3 Tips"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Gunakan UID/GID Numerik"}),": Beberapa platform keamanan lebih suka menggunakan angka daripada nama (misal: USER ",(0,r.jsx)(a.code,{children:"1001"}),") untuk menghindari kebingungan nama di database user Linux."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Lakukan Instalasi Dulu"}),": Pastikan semua perintah ",(0,r.jsx)(a.code,{children:"apk add"})," atau ",(0,r.jsx)(a.code,{children:"apt install"})," dilakukan sebelum instruksi ",(0,r.jsx)(a.code,{children:"USER"}),", karena user biasa tidak punya izin untuk menginstal software."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Prinsip Least Privilege"}),": Hanya berikan izin tulis pada folder yang benar-benar dibutuhkan (seperti folder ",(0,r.jsx)(a.code,{children:"/logs"})," atau ",(0,r.jsx)(a.code,{children:"/tmp"}),")."]}),"\n"]})]})}function o(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);