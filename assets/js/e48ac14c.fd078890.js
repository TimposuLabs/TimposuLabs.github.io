"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[13850],{2508(n,a,e){e.r(a),e.d(a,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"springboot/springboot-mvc-security/jdbc-authentication-bcrypt","title":"JDBC Authentication BCrypt","description":"Materi ini akan membahas cara menerapkan BCrypt, standar enkripsi kata sandi terkuat dan paling banyak digunakan di ekosistem Spring Security pada saat ini.","source":"@site/tutorial/spring/springboot/springboot-mvc-security/09-jdbc-authentication-bcrypt.md","sourceDirName":"springboot/springboot-mvc-security","slug":"/springboot/springboot-mvc-security/jdbc-authentication-bcrypt","permalink":"/spring/springboot/springboot-mvc-security/jdbc-authentication-bcrypt","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"JDBC Authentication BCrypt"},"sidebar":"tutorialSidebar","previous":{"title":"JDBC Authentication","permalink":"/spring/springboot/springboot-mvc-security/jdbc-authentication"},"next":{"title":"JDBC Auth Custom Tables","permalink":"/spring/springboot/springboot-mvc-security/jdbc-auth-custom-table"}}');var r=e(74848),i=e(28453);const s={sidebar_position:9,title:"JDBC Authentication BCrypt"},o=void 0,c={},d=[{value:"\ud83d\udccc Apa itu BCrypt?",id:"-apa-itu-bcrypt",level:2},{value:"1\ufe0f\u20e3 Persiapan Database",id:"1\ufe0f\u20e3-persiapan-database",level:2},{value:"2\ufe0f\u20e3 Dependency",id:"2\ufe0f\u20e3-dependency",level:2},{value:"3\ufe0f\u20e3 Konfigurasi Application Properties",id:"3\ufe0f\u20e3-konfigurasi-application-properties",level:2},{value:"4\ufe0f\u20e3 Implementasi JDBC Authentication",id:"4\ufe0f\u20e3-implementasi-jdbc-authentication",level:2},{value:"\ud83d\udd12 Best Practice: Menggunakan Password Encoder",id:"-best-practice-menggunakan-password-encoder",level:2},{value:"1\ufe0f\u20e3 Persiapan Database",id:"1\ufe0f\u20e3-persiapan-database-1",level:3},{value:"2\ufe0f\u20e3 Konfigurasi Password Encoder",id:"2\ufe0f\u20e3-konfigurasi-password-encoder",level:3},{value:"3\ufe0f\u20e3 BONUS: Cara Membuat Password Terenkripsi Secara Manual",id:"3\ufe0f\u20e3-bonus-cara-membuat-password-terenkripsi-secara-manual",level:3}];function u(n){const a={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.p,{children:["Materi ini akan membahas cara menerapkan ",(0,r.jsx)(a.strong,{children:"BCrypt"}),", standar enkripsi kata sandi terkuat dan paling banyak digunakan di ekosistem ",(0,r.jsx)(a.strong,{children:"Spring Security"})," pada saat ini."]}),"\n",(0,r.jsx)(a.h2,{id:"-apa-itu-bcrypt",children:"\ud83d\udccc Apa itu BCrypt?"}),"\n",(0,r.jsx)(a.p,{children:"BCrypt adalah fungsi hashing kata sandi yang dirancang oleh Niels Provos dan David Mazi\xe8res. Saat ini, BCrypt tetap menjadi pilihan utama karena:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Salting Otomatis"}),": Setiap password akan memiliki salt unik (teks acak tambahan), sehingga dua user dengan password sama akan memiliki hasil enkripsi yang berbeda di database. Ini mencegah serangan Rainbow Table."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Work Factor (Cost)"}),': Kita bisa mengatur seberapa "berat" proses enkripsi dilakukan. Semakin tinggi nilainya, semakin sulit bagi penyerang untuk melakukan ',(0,r.jsx)(a.em,{children:"brute-force"}),"."]}),"\n"]}),"\n",(0,r.jsx)(a.admonition,{type:"tip",children:(0,r.jsxs)(a.p,{children:["Kita bisa menggunakan BCrypt Generator online untuk melakukan Generate dan Verify Hash. Contoh ",(0,r.jsx)(a.a,{href:"https://bcrypt-generator.com/",children:"https://bcrypt-generator.com/"}),"."]})}),"\n",(0,r.jsx)(a.h2,{id:"1\ufe0f\u20e3-persiapan-database",children:"1\ufe0f\u20e3 Persiapan Database"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Spring Security secara default menggunakan struktur tabel tertentu agar dapat bekerja secara otomatis tanpa query tambahan."}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-sql",children:"CREATE TABLE users (\n    username VARCHAR(50) NOT NULL PRIMARY KEY,\n    password VARCHAR(100) NOT NULL,\n    enabled TINYINT NOT NULL\n);\n\nCREATE TABLE authorities (\n    username VARCHAR(50) NOT NULL,\n    authority VARCHAR(50) NOT NULL,\n    CONSTRAINT fk_authorities_users FOREIGN KEY(username) REFERENCES users(username)\n);\n"})}),"\n",(0,r.jsx)(a.admonition,{type:"warning",children:(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Pastikan kolom ",(0,r.jsx)(a.code,{children:"enabled"})," bernilai ",(0,r.jsx)(a.code,{children:"1"})," agar user bisa login."]}),"\n",(0,r.jsxs)(a.li,{children:["Selalu pastikan kolom password di database memiliki panjang minimal ",(0,r.jsx)(a.strong,{children:"68 karakter"})," (disarankan 100) untuk menampung hasil hash BCrypt."]}),"\n"]})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Insert data ",(0,r.jsx)(a.code,{children:"users"})," dan ",(0,r.jsx)(a.code,{children:"authorities"}),":"]}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-sql",children:"INSERT INTO `users` \nVALUES \n-- Password = rahasia123 --\n('aco','{bcrypt}$2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W',1), \n('ade','{bcrypt}$2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W',1),\n('ucup','{bcrypt}$2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W',1);\n\nINSERT INTO `authorities` \nVALUES \n('aco','ROLE_GUEST'),\n('ade','ROLE_GUEST'),\n('ade','ROLE_USERS'),\n('ucup','ROLE_GUEST'),\n('ucup','ROLE_USERS'),\n('ucup','ROLE_ADMIN');\n"})}),"\n",(0,r.jsx)(a.h2,{id:"2\ufe0f\u20e3-dependency",children:"2\ufe0f\u20e3 Dependency"}),"\n",(0,r.jsxs)(a.p,{children:["Tambahkan driver database (contoh: MySQL) dan Spring Data JPA ke dalam ",(0,r.jsx)(a.code,{children:"pom.xml"})," Anda:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-xml",children:"<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-data-jpa</artifactId>\n</dependency>\n<dependency>\n\t<groupId>com.mysql</groupId>\n\t<artifactId>mysql-connector-j</artifactId>\n\t<scope>runtime</scope>\n</dependency>\n"})}),"\n",(0,r.jsx)(a.h2,{id:"3\ufe0f\u20e3-konfigurasi-application-properties",children:"3\ufe0f\u20e3 Konfigurasi Application Properties"}),"\n",(0,r.jsxs)(a.p,{children:["Hubungkan aplikasi ke database melalui file ",(0,r.jsx)(a.code,{children:"application.properties"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-properties",children:"spring.datasource.url=jdbc:mysql://localhost:3306/nama_db_anda\nspring.datasource.username=root\nspring.datasource.password=password_anda\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n"})}),"\n",(0,r.jsx)(a.h2,{id:"4\ufe0f\u20e3-implementasi-jdbc-authentication",children:"4\ufe0f\u20e3 Implementasi JDBC Authentication"}),"\n",(0,r.jsxs)(a.p,{children:["Pada ",(0,r.jsx)(a.code,{children:"SecurityConfig"}),", kita menggunakan ",(0,r.jsx)(a.code,{children:"JdbcUserDetailsManager"})," yang membutuhkan sebuah ",(0,r.jsx)(a.code,{children:"DataSource"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@Configuration\npublic class SecurityConfig {\n\n\t// membuat user konfigurasi dari database\n\t@Bean\n\tpublic UserDetailsManager userDetailsManager(DataSource dataSource) {\n\t\treturn new JdbcUserDetailsManager(dataSource);\t\t\n\t}\n\t\n\t// konfig custom login page\n\t@Bean\n\tpublic SecurityFilterChain filterChain(HttpSecurity httpSecurity) throws Exception {\n\t\t\n\t\thttpSecurity.authorizeHttpRequests(configurer -> \n\t\t\t\t\tconfigurer\n\t\t\t\t\t\t.requestMatchers("/").hasRole("GUEST")\n\t\t\t\t\t\t.requestMatchers("/user/**").hasAnyRole("USERS", "ADMIN")\n\t\t\t\t\t\t.requestMatchers("/admin/**").hasRole("ADMIN")\n\t\t\t\t\t\t.anyRequest().authenticated()\n\t\t\t\t).formLogin(form ->\n\t\t\t\t\tform\n\t\t\t\t\t\t.loginPage("/loginPage")\n\t\t\t\t\t\t.loginProcessingUrl("/authentication")\n\t\t\t\t\t\t.permitAll()\n\t\t\t\t).logout(logout -> \n\t\t\t\t\tlogout.permitAll()\n\t\t\t\t).exceptionHandling(configurer ->\n\t\t\t\t\tconfigurer.accessDeniedPage("/access-denied")\n\t\t\t\t);\n\t\t\n\t\treturn httpSecurity.build();\n\t}\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{type:"info",children:(0,r.jsxs)(a.p,{children:["TIdak ada perbedaan konfigurasi dengan materi ",(0,r.jsx)(a.a,{href:"/spring/springboot/springboot-mvc-security/jdbc-authentication",children:(0,r.jsx)(a.strong,{children:"JDBC Authentication"})})," sebelumnya, yang menmbedakan hanya isi data pada kolom ",(0,r.jsx)(a.code,{children:"password"})," tabel ",(0,r.jsx)(a.code,{children:"users"}),"."]})}),"\n",(0,r.jsx)(a.admonition,{type:"info",children:(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Source Code"}),": ",(0,r.jsx)(a.a,{href:"https://github.com/TimposuLabs/belajar-springboot-mvc-security/tree/main/10-belajar-springboot-security-jdbc-authentication-bcrypt-encryption",children:"https://github.com/TimposuLabs/belajar-springboot-mvc-security/tree/main/10-belajar-springboot-security-jdbc-authentication-bcrypt-encryption"})]})}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"-best-practice-menggunakan-password-encoder",children:"\ud83d\udd12 Best Practice: Menggunakan Password Encoder"}),"\n",(0,r.jsxs)(a.p,{children:["Pada materi di atas kita masih menggunakan format ",(0,r.jsx)(a.code,{children:"{bcrypt}$2a$10$dXJ..."})," pada data kolom ",(0,r.jsx)(a.code,{children:"password"})," tabel ",(0,r.jsx)(a.code,{children:"users"}),". Kita bisa menggunakan ",(0,r.jsx)(a.code,{children:"PasswordEncoder"})," untuk menggunakan data hash ",(0,r.jsx)(a.code,{children:"bcrypt"})," langsung tanpa menggunakan format ",(0,r.jsx)(a.code,{children:"{bcrypt}$2a$10$dXJ..."}),"."]}),"\n",(0,r.jsx)(a.h3,{id:"1\ufe0f\u20e3-persiapan-database-1",children:"1\ufe0f\u20e3 Persiapan Database"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-sql",children:"INSERT INTO `users` \nVALUES \n-- Password = rahasia123 --\n('aco','$2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W',1), \n('ade','$2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W',1),\n('ucup','$2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W',1);\n"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Contoh Hasil Enkripsi di Database dengan password ",(0,r.jsx)(a.em,{children:(0,r.jsx)(a.code,{children:"rahasia123"})}),"."]}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"+----------+--------------------------------------------------------------+---------+\n| username | password                                                     | enabled |\n+----------+--------------------------------------------------------------+---------+\n| aco      | $2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W |       1 |\n| ade      | $2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W |       1 |\n| ucup     | $2a$12$v8mHo6OSrm/ReDDydgFUneA2n1YIu.j8SFwzFvCjTGuDcTtoewB5W |       1 |\n+----------+--------------------------------------------------------------+---------+\n"})}),"\n",(0,r.jsx)(a.h3,{id:"2\ufe0f\u20e3-konfigurasi-password-encoder",children:"2\ufe0f\u20e3 Konfigurasi Password Encoder"}),"\n",(0,r.jsxs)(a.p,{children:["Langkah pertama adalah mendaftarkan ",(0,r.jsx)(a.code,{children:"BCryptPasswordEncoder"})," sebagai sebuah ",(0,r.jsx)(a.strong,{children:"Bean"})," di dalam kelas ",(0,r.jsx)(a.code,{children:"SecurityConfig"})," agar bisa digunakan oleh Spring Security secara global. Contoh konfigurasi lengkap:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@Configuration\npublic class SecurityConfig {\n\n\t// membuat user konfigurasi dari database\n\t@Bean\n\tpublic UserDetailsManager userDetailsManager(DataSource dataSource) {\n\t\treturn new JdbcUserDetailsManager(dataSource);\t\t\n\t}\n\t\n\t// Bean untuk Password Encoder BCrypt\n\t@Bean\n\tpublic PasswordEncoder passwordEncoder() {\n\t\t// Angka 12 adalah \'High security\' (log rounds) cocok production. Standar adalah 10-12.\n\t\treturn new BCryptPasswordEncoder(12);\n\t}\n\t\n\t// konfig custom login page\n\t@Bean\n\tpublic SecurityFilterChain filterChain(HttpSecurity httpSecurity) throws Exception {\n\t\t\n\t\thttpSecurity.authorizeHttpRequests(configurer -> \n\t\t\t\t\tconfigurer\n\t\t\t\t\t\t.requestMatchers("/").hasRole("GUEST")\n\t\t\t\t\t\t.requestMatchers("/user/**").hasAnyRole("USERS", "ADMIN")\n\t\t\t\t\t\t.requestMatchers("/admin/**").hasRole("ADMIN")\n\t\t\t\t\t\t.anyRequest().authenticated()\n\t\t\t\t).formLogin(form ->\n\t\t\t\t\tform\n\t\t\t\t\t\t.loginPage("/loginPage")\n\t\t\t\t\t\t.loginProcessingUrl("/authentication")\n\t\t\t\t\t\t.permitAll()\n\t\t\t\t).logout(logout -> \n\t\t\t\t\tlogout.permitAll()\n\t\t\t\t).exceptionHandling(configurer ->\n\t\t\t\t\tconfigurer.accessDeniedPage("/access-denied")\n\t\t\t\t);\n\t\t\n\t\treturn httpSecurity.build();\n\t}\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{type:"tip",children:(0,r.jsxs)(a.p,{children:["Jika aplikasi anda nantinya berkembang sangat besar (jutaan user), ",(0,r.jsx)(a.em,{children:"cost factor / log rounds"})," 12 mungkin akan terasa sedikit lambat pada hardware server yang pas-pasan (proses hashing bisa memakan waktu >200ms), kita bisa menggunakan ",(0,r.jsx)(a.em,{children:"cost factor"})," 10 (strength) sebagai alternatif. Namun, untuk standar keamanan, angka 12 adalah pilihan yang sangat ",(0,r.jsx)(a.strong,{children:"solid dan aman"})," dari serangan ",(0,r.jsx)(a.em,{children:"brute-force"}),"."]})}),"\n",(0,r.jsx)(a.admonition,{type:"info",children:(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Source Code"}),": ",(0,r.jsx)(a.a,{href:"https://github.com/TimposuLabs/belajar-springboot-mvc-security/tree/main/11-belajar-springboot-security-jdbc-authentication-bcrypt-password-encoder",children:"https://github.com/TimposuLabs/belajar-springboot-mvc-security/tree/main/11-belajar-springboot-security-jdbc-authentication-bcrypt-password-encoder"})]})}),"\n",(0,r.jsx)(a.h3,{id:"3\ufe0f\u20e3-bonus-cara-membuat-password-terenkripsi-secara-manual",children:"3\ufe0f\u20e3 BONUS: Cara Membuat Password Terenkripsi Secara Manual"}),"\n",(0,r.jsx)(a.p,{children:"Saat mendaftarkan user baru atau memasukkan data awal ke database, kita harus mengenkripsi password tersebut terlebih dahulu. Jangan pernah memasukkan teks biasa ke database."}),"\n",(0,r.jsx)(a.p,{children:"Contoh Test Code untuk Generate Hash:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'public class PasswordGenerator {\n    public static void main(String[] args) {\n        BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();\n        String rawPassword = "rahasia123";\n        String encodedPassword = encoder.encode(rawPassword);\n        \n        System.out.println("Hasil Enkripsi: " + encodedPassword);\n    }\n}\n'})})]})}function l(n={}){const{wrapper:a}={...(0,i.R)(),...n.components};return a?(0,r.jsx)(a,{...n,children:(0,r.jsx)(u,{...n})}):u(n)}},28453(n,a,e){e.d(a,{R:()=>s,x:()=>o});var t=e(96540);const r={},i=t.createContext(r);function s(n){const a=t.useContext(i);return t.useMemo(function(){return"function"==typeof n?n(a):{...a,...n}},[a,n])}function o(n){let a;return a=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),t.createElement(i.Provider,{value:a},n.children)}}}]);