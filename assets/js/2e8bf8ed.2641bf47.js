"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[5619],{17053(n,e,a){a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"springboot/springboot-jpa-hibernate/many-to-many","title":"Many-to-Many Mapping","description":"Relasi Many-to-Many terjadi ketika banyak baris di Tabel A dapat berhubungan dengan banyak baris di Tabel B.","source":"@site/tutorial/spring/springboot/springboot-jpa-hibernate/22-many-to-many.md","sourceDirName":"springboot/springboot-jpa-hibernate","slug":"/springboot/springboot-jpa-hibernate/many-to-many","permalink":"/spring/springboot/springboot-jpa-hibernate/many-to-many","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":22,"frontMatter":{"sidebar_position":22,"title":"Many-to-Many Mapping"},"sidebar":"tutorialSidebar","previous":{"title":"One-to-Many Uni-Directional","permalink":"/spring/springboot/springboot-jpa-hibernate/one-to-many-uni-directional"},"next":{"title":"Many-to-Many Create","permalink":"/spring/springboot/springboot-jpa-hibernate/many-to-many-create"}}');var t=a(74848),s=a(28453);const r={sidebar_position:22,title:"Many-to-Many Mapping"},d=void 0,l={},o=[{value:"\ud83d\ude80 Implementasi Entity",id:"-implementasi-entity",level:2},{value:"1\ufe0f\u20e3 Entity <code>Student</code> (Sisi Owner)",id:"1\ufe0f\u20e3-entity-student-sisi-owner",level:3},{value:"2\ufe0f\u20e3 Entity <code>Course</code> (Sisi Inverse)",id:"2\ufe0f\u20e3-entity-course-sisi-inverse",level:3},{value:"\ud83d\udccc Poin Penting",id:"-poin-penting",level:2},{value:"\ud83d\udcc5 Penggunaan <code>@JoinTable</code> dan <code>@JoinColumn</code>",id:"-penggunaan-jointable-dan-joincolumn",level:2},{value:"1\ufe0f\u20e3 Siapa yang harus menjadi &quot;Owner&quot;?",id:"1\ufe0f\u20e3-siapa-yang-harus-menjadi-owner",level:3},{value:"2\ufe0f\u20e3 Contoh Struktur di Sisi Student (Owner)",id:"2\ufe0f\u20e3-contoh-struktur-di-sisi-student-owner",level:3},{value:"3\ufe0f\u20e3 Apa yang terjadi di sisi Course (Inverse Side)?",id:"3\ufe0f\u20e3-apa-yang-terjadi-di-sisi-course-inverse-side",level:3},{value:"\ud83d\udd01 Perbandingan Jika Terbalik",id:"-perbandingan-jika-terbalik",level:3},{value:"\ud83d\udc4d Kesimpulan Penggunaan <code>@JoinTable</code> dan <code>@JoinColumn</code>",id:"-kesimpulan-penggunaan-jointable-dan-joincolumn",level:3}];function c(n){const e={code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.p,{children:["Relasi ",(0,t.jsx)(e.strong,{children:"Many-to-Many"})," terjadi ketika banyak baris di Tabel A dapat berhubungan dengan banyak baris di Tabel B."]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"Hibernate",src:a(42962).A+"",width:"543",height:"323"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Studi Kasus"}),": Seorang Siswa(",(0,t.jsx)(e.code,{children:"Student"}),") dapat mengambil banyak Mata Pelajaran(",(0,t.jsx)(e.code,{children:"Course"}),"), dan satu Mata Pelajaran(",(0,t.jsx)(e.code,{children:"Course"}),") dapat diikuti oleh banyak Siswa(",(0,t.jsx)(e.code,{children:"Student"}),")."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Junction Table"}),": Dalam database relasional, relasi ini wajib menggunakan ",(0,t.jsx)(e.strong,{children:"tabel perantara"})," (misal: ",(0,t.jsx)(e.code,{children:"course_student"}),") yang menyimpan pasangan ID dari kedua tabel utama."]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"Hibernate",src:a(81786).A+"",width:"835",height:"236"})}),"\n",(0,t.jsx)(e.h2,{id:"-implementasi-entity",children:"\ud83d\ude80 Implementasi Entity"}),"\n",(0,t.jsxs)(e.h3,{id:"1\ufe0f\u20e3-entity-student-sisi-owner",children:["1\ufe0f\u20e3 Entity ",(0,t.jsx)(e.code,{children:"Student"})," (Sisi Owner)"]}),"\n",(0,t.jsxs)(e.p,{children:['Sisi "Owner" adalah entitas yang menentukan konfigurasi tabel penghubung menggunakan ',(0,t.jsx)(e.code,{children:"@JoinTable"}),"."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Entity\r\n@Table(name = "student")\r\npublic class Student {\r\n\r\n\t@Id\r\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\tprivate Integer id;\r\n\t\r\n\t@Column(name = "first_name")\r\n\tprivate String firstName;\r\n\t\r\n\t@Column(name = "last_name")\r\n\tprivate String lastName;\r\n\t\r\n\t@ManyToMany(\r\n                fetch = FetchType.LAZY,\r\n                cascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\t@JoinTable(\r\n                name = "course_student", // Nama tabel penghubung di DB\r\n                joinColumns = @JoinColumn(name = "student_id"), // FK ke tabel student\r\n                inverseJoinColumns = @JoinColumn(name = "course_id")) // FK ke tabel course\r\n\tprivate Set<Course> courses = new HashSet<>();\r\n\t\r\n\tpublic Student() {\t\t\r\n\t}\r\n\r\n\tpublic Student(String firstName, String lastName) {\r\n\t\tthis.firstName = firstName;\r\n\t\tthis.lastName = lastName;\r\n\t}\r\n\r\n        // HELPER METHOD: Menjaga sinkronisasi dua arah di memori\r\n\tpublic void addCourse(Course course) {\r\n            if (course == null) return;\r\n\r\n            if (courses == null) {\r\n                courses = new HashSet<>();\r\n            }\r\n\r\n            // Cek apakah course sudah ada, jika belum baru tambahkan\r\n            if (!courses.contains(course)) {\r\n                courses.add(course);\r\n                // Panggil sisi lawan untuk sinkronisasi\r\n                course.addStudent(this);\r\n            }\r\n        }\r\n\r\n\t// Implementasi Setter & Getter lainnya\r\n\r\n}\n'})}),"\n",(0,t.jsxs)(e.h3,{id:"2\ufe0f\u20e3-entity-course-sisi-inverse",children:["2\ufe0f\u20e3 Entity ",(0,t.jsx)(e.code,{children:"Course"})," (Sisi Inverse)"]}),"\n",(0,t.jsxs)(e.p,{children:["Sisi ini menggunakan atribut ",(0,t.jsx)(e.code,{children:"mappedBy"})," yang merujuk pada nama variabel di class ",(0,t.jsx)(e.code,{children:"Student"}),"."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Entity\r\n@Table(name = "course")\r\npublic class Course {\r\n\r\n\t@Id\r\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\tprivate Integer id;\r\n\t\r\n\t@Column(name = "course_name")\r\n\tprivate String courseName;\r\n\t\r\n\t@ManyToMany(\r\n\t\t\tmappedBy = "courses",  // Harus sama dengan nama variabel di Student.java\r\n\t\t\tfetch = FetchType.LAZY,\r\n\t\t\tcascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\tprivate Set<Student> students = new HashSet<>();\r\n\t\r\n\tpublic Course() { }\r\n\t\r\n\tpublic Course(String courseName) {\r\n\t\tthis.courseName = courseName;\r\n\t}\r\n\r\n\tpublic void addStudent(Student student) {\r\n\t\tif (student == null) return;\r\n\t\t\r\n\t\tif (students == null) {\r\n\t\t\tstudents = new HashSet<>();\r\n\t\t}\r\n\t\t\r\n\t\tif (!students.contains(student)) {\r\n\t\t\tstudents.add(student);\r\n\t\t\tstudent.addCourse(this);\r\n\t\t}\r\n\t}\r\n\r\n\t// Implementasi Setter & Getter lainnya\r\n\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"-poin-penting",children:"\ud83d\udccc Poin Penting"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsxs)(e.strong,{children:["Gunakan ",(0,t.jsx)(e.code,{children:"Set"})," Bukan ",(0,t.jsx)(e.code,{children:"List"})]}),": Dalam relasi ",(0,t.jsx)(e.strong,{children:"Many-to-Many"}),", sangat disarankan menggunakan ",(0,t.jsx)(e.code,{children:"Set"})," (seperti ",(0,t.jsx)(e.code,{children:"HashSet"}),") untuk performa maksimal. Penggunaan ",(0,t.jsx)(e.code,{children:"List"})," sering memicu Hibernate menghapus seluruh baris di tabel penghubung lalu memasukkannya kembali setiap kali ada perubahan (",(0,t.jsx)(e.strong,{children:"expensive operations"}),")."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsxs)(e.strong,{children:["Hindari ",(0,t.jsx)(e.code,{children:"CascadeType.REMOVE"})]}),": Pada relasi N..M, jangan gunakan ",(0,t.jsx)(e.strong,{children:"cascade remove"}),'. Jika Anda menghapus seorang Siswa, Anda tentu tidak ingin Mata Pelajaran "Matematika" ikut terhapus dari sistem.']}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsxs)(e.strong,{children:["Override ",(0,t.jsx)(e.code,{children:"equals()"})," & ",(0,t.jsx)(e.code,{children:"hashCode()"})]}),": Karena menggunakan ",(0,t.jsx)(e.code,{children:"Set"}),", kita wajib mengimplementasikan ",(0,t.jsx)(e.code,{children:"equals"})," dan ",(0,t.jsx)(e.code,{children:"hashCode"})," berdasarkan ID entitas agar pengecekan ",(0,t.jsx)(e.code,{children:".contains()"})," akurat."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Infinite Recursion"}),": Jika Anda mengonversi entitas ke JSON (misal untuk API), gunakan anotasi ",(0,t.jsx)(e.code,{children:"@JsonIgnore"})," agar tidak terjadi looping antara ",(0,t.jsx)(e.code,{children:"Student"})," memanggil ",(0,t.jsx)(e.code,{children:"Course"})," dan ",(0,t.jsx)(e.code,{children:"Course"})," memanggil ",(0,t.jsx)(e.code,{children:"Student"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"-penggunaan-jointable-dan-joincolumn",children:["\ud83d\udcc5 Penggunaan ",(0,t.jsx)(e.code,{children:"@JoinTable"})," dan ",(0,t.jsx)(e.code,{children:"@JoinColumn"})]}),"\n",(0,t.jsxs)(e.p,{children:["Dalam relasi ",(0,t.jsx)(e.strong,{children:"Many-to-Many"}),", penempatan ",(0,t.jsx)(e.code,{children:"@JoinTable"})," dan ",(0,t.jsx)(e.code,{children:"@JoinColumn"})," sebenarnya bebas diletakkan di entity mana saja (",(0,t.jsx)(e.code,{children:"Student"})," atau ",(0,t.jsx)(e.code,{children:"Course"}),"). Namun, ada aturan praktis (",(0,t.jsx)(e.strong,{children:"best practice"}),") untuk menentukan siapa yang menjadi ",(0,t.jsx)(e.strong,{children:"Owner"})," (pemilik relasi)."]}),"\n",(0,t.jsx)(e.p,{children:"Berikut adalah penjelasannya:"}),"\n",(0,t.jsx)(e.h3,{id:"1\ufe0f\u20e3-siapa-yang-harus-menjadi-owner",children:'1\ufe0f\u20e3 Siapa yang harus menjadi "Owner"?'}),"\n",(0,t.jsx)(e.p,{children:"Biasanya, sisi yang secara logis melakukan aksi dianggap sebagai pemilik relasi (Owner)."}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Dalam kasus sekolah, Siswa (",(0,t.jsx)(e.code,{children:"Student"}),") yang mendaftar ke Mata Pelajaran (",(0,t.jsx)(e.code,{children:"Course"}),")."]}),"\n",(0,t.jsxs)(e.li,{children:["Oleh karena itu, secara desain lebih masuk akal meletakkan ",(0,t.jsx)(e.code,{children:"@JoinTable"})," dan ",(0,t.jsx)(e.code,{children:"@JoinColumn"})," di entity ",(0,t.jsx)(e.code,{children:"Student"}),"."]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"2\ufe0f\u20e3-contoh-struktur-di-sisi-student-owner",children:"2\ufe0f\u20e3 Contoh Struktur di Sisi Student (Owner)"}),"\n",(0,t.jsxs)(e.p,{children:["Jika Anda memilih ",(0,t.jsx)(e.code,{children:"Student"})," sebagai ",(0,t.jsx)(e.em,{children:"owner"}),", maka kodenya seperti ini:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Entity\r\npublic class Student {\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    @ManyToMany\r\n    @JoinTable(\r\n        name = "student_courses", // Nama tabel penghubung\r\n        joinColumns = @JoinColumn(name = "student_id"), // FK ke tabel Student\r\n        inverseJoinColumns = @JoinColumn(name = "course_id") // FK ke tabel Course\r\n    )\r\n    private Set<Course> courses = new HashSet<>();\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"3\ufe0f\u20e3-apa-yang-terjadi-di-sisi-course-inverse-side",children:"3\ufe0f\u20e3 Apa yang terjadi di sisi Course (Inverse Side)?"}),"\n",(0,t.jsxs)(e.p,{children:["Sisi satunya (",(0,t.jsx)(e.code,{children:"Course"}),")  ",(0,t.jsx)(e.strong,{children:"tidak boleh"})," menggunakan ",(0,t.jsx)(e.code,{children:"@JoinColumn"})," lagi. Ia harus menggunakan atribut ",(0,t.jsx)(e.code,{children:"mappedBy"})," untuk merujuk ke field yang ada di class ",(0,t.jsx)(e.code,{children:"Student"}),"."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Entity\r\npublic class Course {\r\n    @Id\r\n    private Long id;\r\n\r\n    @ManyToMany(mappedBy = "courses") // "courses" adalah nama variabel di class Student\r\n    private Set<Student> students = new HashSet<>();\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"-perbandingan-jika-terbalik",children:"\ud83d\udd01 Perbandingan Jika Terbalik"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"Penempatan"}),(0,t.jsx)(e.th,{children:"Kelebihan"}),(0,t.jsx)(e.th,{children:"Keterangan"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:(0,t.jsxs)(e.strong,{children:["Di sisi ",(0,t.jsx)(e.code,{children:"Student"})]})}),(0,t.jsx)(e.td,{children:"Logis secara bisnis."}),(0,t.jsx)(e.td,{children:'"Siswa mengambil Kursus". Paling umum digunakan. \u2705'})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:(0,t.jsxs)(e.strong,{children:["Di sisi ",(0,t.jsx)(e.code,{children:"Course"})]})}),(0,t.jsx)(e.td,{children:"Secara teknis bisa."}),(0,t.jsx)(e.td,{children:'"Kursus diikuti oleh Siswa". Kurang lazim secara alur aplikasi. \u26a0\ufe0f'})]})]})]}),"\n",(0,t.jsxs)(e.h3,{id:"-kesimpulan-penggunaan-jointable-dan-joincolumn",children:["\ud83d\udc4d Kesimpulan Penggunaan ",(0,t.jsx)(e.code,{children:"@JoinTable"})," dan ",(0,t.jsx)(e.code,{children:"@JoinColumn"})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Bisa"})," di mana saja, tetapi pilih salah satu. ",(0,t.jsx)(e.strong,{children:"Jangan"})," pasang ",(0,t.jsx)(e.code,{children:"@JoinTable"})," di kedua sisi karena Hibernate akan membuat dua tabel penghubung yang berbeda, yang akan merusak integritas data Anda."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Sangat disarankan"})," meletakkannya di entitas yang paling sering menjadi titik awal operasi (dalam hal ini ",(0,t.jsx)(e.code,{children:"Student"}),").\r\n*Pastikan menggunakan ",(0,t.jsx)(e.code,{children:"Set"})," daripada ",(0,t.jsx)(e.code,{children:"List"})," untuk performa many-to-many yang lebih baik di Hibernate."]}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},28453(n,e,a){a.d(e,{R:()=>r,x:()=>d});var i=a(96540);const t={},s=i.createContext(t);function r(n){const e=i.useContext(s);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:r(n.components),i.createElement(s.Provider,{value:e},n.children)}},42962(n,e,a){a.d(e,{A:()=>i});const i=a.p+"assets/images/many-to-many2-6c51444831c45248198d541c92c53b3c.png"},81786(n,e,a){a.d(e,{A:()=>i});const i=a.p+"assets/images/many-to-many-6aa81602769493b1c2929977a8044fb9.png"}}]);