"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[90775],{28453(e,n,t){t.d(n,{R:()=>s,x:()=>d});var a=t(96540);const r={},i=a.createContext(r);function s(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(i.Provider,{value:n},e.children)}},43814(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"springboot/springboot-jpa-hibernate/update-data","title":"Update Data","description":"Dalam Hibernate, melakukan pembaruan (update) data sedikit berbeda dengan SQL biasa. Hibernate menggunakan konsep Dirty Checking, di mana ia secara otomatis mendeteksi perubahan pada objek yang sedang \\"dikelola\\" (managed) dan menyimpannya ke database saat transaksi selesai.","source":"@site/tutorial/spring/springboot/springboot-jpa-hibernate/06-update-data.md","sourceDirName":"springboot/springboot-jpa-hibernate","slug":"/springboot/springboot-jpa-hibernate/update-data","permalink":"/spring/springboot/springboot-jpa-hibernate/update-data","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Update Data"},"sidebar":"tutorialSidebar","previous":{"title":"JPQL","permalink":"/spring/springboot/springboot-jpa-hibernate/jpql"},"next":{"title":"Delete Data","permalink":"/spring/springboot/springboot-jpa-hibernate/delete-data"}}');var r=t(74848),i=t(28453);const s={sidebar_position:6,title:"Update Data"},d=void 0,l={},u=[{value:"A. Mekanisme Update: Cara &quot;Managed Entity&quot;",id:"a-mekanisme-update-cara-managed-entity",level:3},{value:"B. Update dengan EntityManager (Pendekatan DAO)",id:"b-update-dengan-entitymanager-pendekatan-dao",level:3},{value:"C. Update Manual dengan JPQL",id:"c-update-manual-dengan-jpql",level:3},{value:"1\ufe0f\u20e3 Repository / DAO",id:"1\ufe0f\u20e3-repository--dao",level:2},{value:"2\ufe0f\u20e3 Main Class",id:"2\ufe0f\u20e3-main-class",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Dalam Hibernate, melakukan pembaruan (update) data sedikit berbeda dengan SQL biasa. Hibernate menggunakan konsep ",(0,r.jsx)(n.strong,{children:"Dirty Checking"}),', di mana ia secara otomatis mendeteksi perubahan pada objek yang sedang "dikelola" (managed) dan menyimpannya ke database saat transaksi selesai.']}),"\n",(0,r.jsx)(n.h3,{id:"a-mekanisme-update-cara-managed-entity",children:'A. Mekanisme Update: Cara "Managed Entity"'}),"\n",(0,r.jsx)(n.p,{children:"Langkah-langkah:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ambil data dari database (objek menjadi status ",(0,r.jsx)(n.em,{children:"managed"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Ubah nilai pada objek menggunakan ",(0,r.jsx)(n.code,{children:"setter"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Selesaikan transaksi (Hibernate otomatis menjalankan SQL ",(0,r.jsx)(n.code,{children:"UPDATE"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"b-update-dengan-entitymanager-pendekatan-dao",children:"B. Update dengan EntityManager (Pendekatan DAO)"}),"\n",(0,r.jsxs)(n.p,{children:["Jika menggunakan EntityManager secara manual (seperti contoh DAO sebelumnya), kita menggunakan method ",(0,r.jsx)(n.code,{children:"merge()"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@Override\r\n@Transactional\r\npublic void update(Student student) {\r\n    // Membawa objek kembali ke status 'managed' dan memperbarui database\r\n    entityManager.merge(student);\r\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"c-update-manual-dengan-jpql",children:"C. Update Manual dengan JPQL"}),"\n",(0,r.jsxs)(n.p,{children:["Gunakan cara ini jika Anda ingin mengubah data tanpa harus mengambilnya ke memori Java terlebih dahulu (lebih efisien untuk update banyak data sekaligus / rekomendasi jika ingin ",(0,r.jsx)(n.strong,{children:"Bulk Update"}),")."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Override\r\n@Transactional\r\npublic int updateEmailById(Long id, String newEmail) {\r\n\t// 1. Definisikan JPQL\r\n\tString jpql = "UPDATE Student s SET s.email = :emailBaru WHERE s.id = :idStudent";\r\n\r\n\t// 2. Buat TypedQuery\r\n\t// Meskipun ini operasi update, kita definisikan return type-nya sebagai Student (atau Integer)\r\n\tTypedQuery<Integer> query = (TypedQuery<Integer>) entityManager.createQuery(jpql);\r\n\r\n\t// 3. Set Parameter (Mencegah SQL Injection)\r\n\tquery.setParameter("emailBaru", newEmail);\r\n\tquery.setParameter("idStudent", id);\r\n\r\n\t// 4. Eksekusi Update\r\n\t// Output: jumlah baris yang berhasil diubah\r\n\tint rowsUpdated = query.executeUpdate();\r\n\r\n\treturn rowsUpdated;\r\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"Berikut kita akan implementasikan update data dari project tutorial sebelumnya."}),"\n",(0,r.jsx)(n.h2,{id:"1\ufe0f\u20e3-repository--dao",children:"1\ufe0f\u20e3 Repository / DAO"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Menambahkan method baru pada interface DAO dengan menambahkan method ",(0,r.jsx)(n.code,{children:"update"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public interface StudentDAO {\r\n\r\n   \tvoid save(Student student);\r\n\t\r\n\tStudent findById(Long id);\r\n\t\r\n\tList<Student> findAll();\r\n\t\r\n\tList<Student> findByLastName(String lastName);\r\n\r\n\tvoid update(Student student);\r\n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Implementasi DAO:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Repository\r\npublic class StudentDAOImpl implements StudentDAO {\r\n\r\n\tprivate EntityManager entityManager;\r\n\t\r\n\tpublic StudentDAOImpl(EntityManager entityManager) {\r\n\t\tthis.entityManager = entityManager;\r\n\t}\r\n\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void save(Student student) {\r\n\t\tentityManager.persist(student);\r\n\t}\r\n\r\n\t@Override\r\n\t@Transactional(readOnly = true)\r\n\tpublic Student findById(Long id) {\r\n\t\treturn entityManager.find(Student.class, id);\r\n\t}\r\n\t\t\r\n\t@Override\r\n\t@Transactional(readOnly = true)\r\n\tpublic List<Student> findAll() {\t\t\r\n\t\tTypedQuery<Student> query = entityManager.createQuery("FROM Student ORDER BY lastName asc", Student.class);\t\t\r\n\t\treturn query.getResultList();\r\n\t}\r\n\t\r\n\t@Override\r\n\t@Transactional(readOnly = true)\r\n\tpublic List<Student> findByLastName(String lastName) {\r\n\t\tTypedQuery<Student> query = entityManager.createQuery("FROM Student WHERE lastName=:theLastName", Student.class);\r\n\t\tquery.setParameter("theLastName", lastName);\r\n\t\treturn query.getResultList();\r\n\t}\r\n\t\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void update(Student student) {\r\n\t\tentityManager.merge(student);\r\n\t}\r\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"2\ufe0f\u20e3-main-class",children:"2\ufe0f\u20e3 Main Class"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Selanjutnya pada main class kita akan menjalankan proses update data:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@SpringBootApplication\r\npublic class Application {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(Application.class, args);\r\n\t}\r\n\r\n\t// Method ini akan mencetak di command line\r\n\t@Bean\r\n\tpublic CommandLineRunner commandLineRunner(StudentDAO studentDAO) {\r\n\t\treturn runner -> {\r\n\r\n\t\tupdateStudent(studentDAO);\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\t\r\n\tprivate void updateStudent(StudentDAO studentDAO) {\r\n\t\tLong id = 6L; // sesuiakan dengan id student yang ingin di ubah\r\n\t\tSystem.out.println("Get student with id = " + id);\r\n\t\tStudent student = studentDAO.findById(id);\t\r\n\t\t\r\n\t\tSystem.out.println("Update Student...");\r\n\t\tstudent.setEmail("aco@gmail.com");\r\n\t\t\r\n\t\tstudentDAO.update(student);\r\n\t\tSystem.out.println("Updated student= " + student);\r\n\t}\r\n}\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Jika sukses maka outputnya sebagai berikut:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Get student with id = 6\r\nHibernate: select s1_0.id,s1_0.email,s1_0.first_name,s1_0.last_name from student s1_0 where s1_0.id=?\r\nUpdate Student...\r\nHibernate: select s1_0.id,s1_0.email,s1_0.first_name,s1_0.last_name from student s1_0 where s1_0.id=?\r\nHibernate: update student set email=?,first_name=?,last_name=? where id=?\r\nUpdated student= Student [id=6, firstName=Inaya, lastName=Rusli, email=aco@gmail.com]\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cek database apakah data sudah terupdate:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"mysql> select * from student where id=6;\r\n+----+---------------+------------+-----------+\r\n| id | email         | first_name | last_name |\r\n+----+---------------+------------+-----------+\r\n|  6 | aco@gmail.com | Inaya      | Rusli     |\r\n+----+---------------+------------+-----------+\r\n1 row in set (0.00 sec)\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Source Code"}),": ",(0,r.jsx)(n.a,{href:"https://github.com/TimposuLabs/belajar-springboot-jpa-hibernate-basic/tree/main/05-belajar-hibernate-update-data",children:"https://github.com/TimposuLabs/belajar-springboot-jpa-hibernate-basic/tree/main/05-belajar-hibernate-update-data"})]})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);