"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[19181],{28453(n,a,e){e.d(a,{R:()=>d,x:()=>l});var i=e(96540);const r={},s=i.createContext(r);function d(n){const a=i.useContext(s);return i.useMemo(function(){return"function"==typeof n?n(a):{...a,...n}},[a,n])}function l(n){let a;return a=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:d(n.components),i.createElement(s.Provider,{value:a},n.children)}},41249(n,a,e){e.d(a,{A:()=>i});const i=e.p+"assets/images/docker6-bfb781bb1660f75b2d2b682f71c277b8.png"},70558(n,a,e){e.r(a),e.d(a,{assets:()=>c,contentTitle:()=>l,default:()=>g,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"load-balancing","title":"Load Balancing","description":"\ud83e\udd14 Apa itu Load Balancing?","source":"@site/tutorial/docker/11-load-balancing.md","sourceDirName":".","slug":"/load-balancing","permalink":"/docker/load-balancing","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12,"title":"Load Balancing"},"sidebar":"tutorialSidebar","previous":{"title":"Reverse Proxy","permalink":"/docker/reverse-proxy"},"next":{"title":"Docker Volume","permalink":"/docker/docker-volume"}}');var r=e(74848),s=e(28453);const d={sidebar_position:12,title:"Load Balancing"},l=void 0,c={},o=[{value:"\ud83e\udd14 Apa itu Load Balancing?",id:"-apa-itu-load-balancing",level:2},{value:"1\ufe0f\u20e3 Load Balancing di Docker",id:"1\ufe0f\u20e3-load-balancing-di-docker",level:2},{value:"A. Internal Load Balancing (Docker DNS)",id:"a-internal-load-balancing-docker-dns",level:3},{value:"B. External Load Balancing (Reverse Proxy)",id:"b-external-load-balancing-reverse-proxy",level:3},{value:"2\ufe0f\u20e3 Implementasi dengan Nginx",id:"2\ufe0f\u20e3-implementasi-dengan-nginx",level:2},{value:"A. Konfigurasi Nginx",id:"a-konfigurasi-nginx",level:3},{value:"B. Membuat Docker Image",id:"b-membuat-docker-image",level:3},{value:"C. Uji Coba \ud83d\udd25",id:"c-uji-coba-",level:3}];function t(n){const a={code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.h2,{id:"-apa-itu-load-balancing",children:"\ud83e\udd14 Apa itu Load Balancing?"}),"\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Load Balancing"})," di Docker adalah teknik untuk membagi beban trafik (",(0,r.jsx)(a.em,{children:"request"}),") ke beberapa kontainer aplikasi yang identik. Load balancing ini berguna agar salah satu server yang mendapatkan banyak lalu lintas (trafik) kunjungan tidak mengalami kelebihan beban."]}),"\n",(0,r.jsxs)(a.p,{children:["Kita tidak lagi mengandalkan satu kontainer besar (",(0,r.jsx)(a.em,{children:"vertical scaling"}),"), melainkan menggunakan banyak kontainer kecil yang bekerja bersamaan (",(0,r.jsx)(a.em,{children:"horizontal scaling"}),"). Jika satu kontainer mati, aplikasi tetap hidup karena masih ada kontainer lain."]}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"Docker Network",src:e(41249).A+"",width:"652",height:"430"})}),"\n",(0,r.jsx)(a.h2,{id:"1\ufe0f\u20e3-load-balancing-di-docker",children:"1\ufe0f\u20e3 Load Balancing di Docker"}),"\n",(0,r.jsx)(a.p,{children:"Terdapat dua cara utama untuk melakukan Load Balancing:"}),"\n",(0,r.jsx)(a.h3,{id:"a-internal-load-balancing-docker-dns",children:"A. Internal Load Balancing (Docker DNS)"}),"\n",(0,r.jsxs)(a.p,{children:["Docker memiliki load balancer bawaan di dalam ",(0,r.jsx)(a.strong,{children:"Libnetwork"}),"."]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Jika kita menjalankan satu service dengan 3 replika dalam satu network, Docker akan memberikan satu alamat DNS virtual."}),"\n",(0,r.jsxs)(a.li,{children:["Setiap kali ada permintaan ke nama service tersebut, Docker akan membaginya secara ",(0,r.jsx)(a.em,{children:"Round-Robin"})," (bergiliran) ke IP internal masing-masing kontainer."]}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"b-external-load-balancing-reverse-proxy",children:"B. External Load Balancing (Reverse Proxy)"}),"\n",(0,r.jsxs)(a.p,{children:["Menggunakan perangkat lunak khusus seperti ",(0,r.jsx)(a.strong,{children:"Nginx"}),", ",(0,r.jsx)(a.strong,{children:"HAProxy"}),", atau ",(0,r.jsx)(a.strong,{children:"Traefik"})," sebagai pintu gerbang utama yang mengatur pembagian trafik berdasarkan algoritma tertentu."]}),"\n",(0,r.jsx)(a.h2,{id:"2\ufe0f\u20e3-implementasi-dengan-nginx",children:"2\ufe0f\u20e3 Implementasi dengan Nginx"}),"\n",(0,r.jsx)(a.p,{children:"Dalam arsitektur contoh kasus ini, kita akan membuat sebuah jaringan privat."}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"Docker Network",src:e(41249).A+"",width:"652",height:"430"})}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.strong,{children:"Keterangan:"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Client (User)"}),": User hanya berkomunikasi dengan satu titik masuk, yaitu NGINX."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"NGINX (Reverse Proxy & Load Balancer)"}),': Bertindak sebagai "penjaga gerbang" utama. Tugasnya adalah menerima semua permintaan / request dan membaginya ke backend.']}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"App 1, App 2, App 3 (Backend Applications)"}),": Ini adalah beberapa replika kontainer aplikasi (misalnya, tiga kontainer Spring Boot yang identik). Mereka menerima beban yang dibagi oleh NGINX."]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Backend Network (Jaringan Internal Docker)"}),": Ini adalah jaringan privat yang mengisolasi aplikasi backend dari jaringan luar. NGINX dan aplikasi backend berada dalam jaringan yang sama."]}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"a-konfigurasi-nginx",children:"A. Konfigurasi Nginx"}),"\n",(0,r.jsxs)(a.p,{children:["Membuat file konfigurasi ",(0,r.jsx)(a.code,{children:"load-balancing.conf"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:"upstream backend {\n  server springboot-app-1:8080;\n  server springboot-app-2:8080;\n  server springboot-app-3:8080;\n}\n\nserver {\n  listen 80;\n\n  location / {\n    proxy_pass http://backend;\n  }\n}\n"})}),"\n",(0,r.jsx)(a.h3,{id:"b-membuat-docker-image",children:"B. Membuat Docker Image"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Membuat dockerfile dari base image Nginx dan melakukan copy file ",(0,r.jsx)(a.code,{children:"load-balancing.conf"})," yang telah dibuat ke dalam image Nginx."]}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-dockerfile",children:"FROM nginx:stable-bullseye\nCOPY load-balancing.conf /etc/nginx/conf.d/default.conf\n"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Build Image:"}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker image build -t webserver:2.0.0 .\n"})}),"\n",(0,r.jsx)(a.h3,{id:"c-uji-coba-",children:"C. Uji Coba \ud83d\udd25"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Membuat Container ",(0,r.jsx)(a.code,{children:"springboot-app-1"}),":"]}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker container run -d --rm --name springboot-app-1 --network backend-network topekox/springboot-hello:1.0\n"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Membuat Container ",(0,r.jsx)(a.code,{children:"springboot-app-2"}),":"]}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker container run -d --rm --name springboot-app-2 --network backend-network topekox/springboot-hello:1.0\n"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["Membuat Container ",(0,r.jsx)(a.code,{children:"springboot-app-3"}),":"]}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker container run -d --rm --name springboot-app-3 --network backend-network topekox/springboot-hello:1.0\n"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Membuat Container web server Nginx:"}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker container run -d --rm --name webserver --network backend-network -p 80:80 webserver:2.0.0\n"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Cek inspect network:"}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'docker network inspect backend-network\n\n"Containers": {\n    "32cac5fa20b415e60d7ca5d43c540ae4f81e4f2379da592277b221745b55fc32": {\n        "Name": "springboot-app-3",\n        "EndpointID": "5042596dffd464dca6707174e668e16da53d1dc6bc1830623bf9f8d0b7a22adf",\n        "MacAddress": "be:ae:de:15:60:50",\n        "IPv4Address": "172.18.0.4/16",\n        "IPv6Address": ""\n    },\n    "37dbe8971f6bf90db3de9f96d9dc746f771dd6c3981eef147147a5d0eb8ba213": {\n        "Name": "springboot-app-1",\n        "EndpointID": "9d5e80aff269ddaa034acce1fe535a37ee2299d14a6ac6809ccaac77ce5b4d15",\n        "MacAddress": "96:4b:de:32:b5:d9",\n        "IPv4Address": "172.18.0.2/16",\n        "IPv6Address": ""\n    },\n    "98d1e8fe04839a5d3a71f05bad8d8ec7de3b63691f6fb617b8829d7609caea0a": {\n        "Name": "webserver",\n        "EndpointID": "e7cf6a96abd4b2b035e85fb2df5ab31dc9f6752f91afa00d132918cb60a855c3",\n        "MacAddress": "ce:a0:54:2e:74:8b",\n        "IPv4Address": "172.18.0.5/16",\n        "IPv6Address": ""\n    },\n    "a528fefd8f18415af60b43d8e7dcbb5eacefa38a7cd8847739efc7142f11ac2a": {\n        "Name": "springboot-app-2",\n        "EndpointID": "d4e1c657f07aaabd947d1b0e2f31779dfbf99a0dc9f994773bcf96067f3557c6",\n        "MacAddress": "0e:a7:34:ca:11:84",\n        "IPv4Address": "172.18.0.3/16",\n        "IPv6Address": ""\n    }\n}\n'})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"Testing"}),": Ketika kita melakukan request ke alamat API ",(0,r.jsx)(a.code,{children:"http://localhost:80/hello"})," maka ip addres yang di tampilkan akan berubah-ubah"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Percobaan 1:"}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{"message":"Hello from Spring Boot!","hostname":"37dbe8971f6b","host":"172.18.0.2"}\n'})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Percobaan 2:"}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{"message":"Hello from Spring Boot!","hostname":"a528fefd8f18","host":"172.18.0.3"}\n'})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Percobaan 3:"}),"\n"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{"message":"Hello from Spring Boot!","hostname":"32cac5fa20b4","host":"172.18.0.4"}\n'})}),"\n"]}),"\n"]})]})}function g(n={}){const{wrapper:a}={...(0,s.R)(),...n.components};return a?(0,r.jsx)(a,{...n,children:(0,r.jsx)(t,{...n})}):t(n)}}}]);