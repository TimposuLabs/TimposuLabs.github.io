"use strict";(globalThis.webpackChunktimposu=globalThis.webpackChunktimposu||[]).push([[9722],{28453(e,n,t){t.d(n,{R:()=>i,x:()=>d});var a=t(96540);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}},33670(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"springboot/springboot-jpa-hibernate/one-to-many-delete","title":"One-to-Many Delete","description":"Hibernate","source":"@site/tutorial/spring/springboot/springboot-jpa-hibernate/20-one-to-many-delete.md","sourceDirName":"springboot/springboot-jpa-hibernate","slug":"/springboot/springboot-jpa-hibernate/one-to-many-delete","permalink":"/spring/springboot/springboot-jpa-hibernate/one-to-many-delete","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20,"title":"One-to-Many Delete"},"sidebar":"tutorialSidebar","previous":{"title":"One-to-Many Update","permalink":"/spring/springboot/springboot-jpa-hibernate/one-to-many-update"},"next":{"title":"One-to-Many Uni-Directional","permalink":"/spring/springboot/springboot-jpa-hibernate/one-to-many-uni-directional"}}');var s=t(74848),r=t(28453);const i={sidebar_position:20,title:"One-to-Many Delete"},d=void 0,l={},c=[{value:"1\ufe0f\u20e3 Entity Parrent: <code>Classes.java</code>",id:"1\ufe0f\u20e3-entity-parrent-classesjava",level:2},{value:"2\ufe0f\u20e3 Entity Child: <code>Student.java</code>",id:"2\ufe0f\u20e3-entity-child-studentjava",level:2},{value:"3\ufe0f\u20e3 Delete Parrent <code>Classes</code>",id:"3\ufe0f\u20e3-delete-parrent-classes",level:2},{value:"\ud83d\udee2\ufe0f Update Repository / DAO",id:"\ufe0f-update-repository--dao",level:3},{value:"\u25b6\ufe0f Main Class",id:"\ufe0f-main-class",level:3},{value:"4\ufe0f\u20e3 Delete Child <code>Student</code>",id:"4\ufe0f\u20e3-delete-child-student",level:2},{value:"\ud83d\udee2\ufe0f Repository / DAO",id:"\ufe0f-repository--dao",level:3},{value:"\u25b6\ufe0f Main Class",id:"\ufe0f-main-class-1",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Hibernate",src:t(89053).A+"",width:"782",height:"310"})}),"\n",(0,s.jsxs)(n.p,{children:["Dalam materi kita akan membahas penghapusan data dalam relasi tabel ",(0,s.jsx)(n.strong,{children:"One-to-Many"}),". Pembahasan materi delete ini akan dibahas dari sisi parrent(",(0,s.jsx)(n.code,{children:"Classes"}),") dan delete dari sisi child(",(0,s.jsx)(n.code,{children:"Student"}),")."]}),"\n",(0,s.jsxs)(n.h2,{id:"1\ufe0f\u20e3-entity-parrent-classesjava",children:["1\ufe0f\u20e3 Entity Parrent: ",(0,s.jsx)(n.code,{children:"Classes.java"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Entity\r\n@Table(name = "classes")\r\npublic class Classes {\r\n\r\n\t@Id\r\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\tprivate Integer id;\r\n\t\r\n\t@Column(name = "class_name")\r\n\tprivate String className;\r\n\t\r\n\t@OneToOne(cascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\t@JoinColumn(name = "teacher_id")\r\n\tprivate Teacher teacher;\r\n\t\r\n\t@OneToMany(\r\n\t\tmappedBy = "classes",\r\n\t\tfetch = FetchType.LAZY,\r\n\t\tcascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\tList<Student> students = new ArrayList<>();\r\n\r\n\t// Setter & Getter\r\n\r\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"2\ufe0f\u20e3-entity-child-studentjava",children:["2\ufe0f\u20e3 Entity Child: ",(0,s.jsx)(n.code,{children:"Student.java"})]}),"\n",(0,s.jsxs)(n.p,{children:["Sisi ",(0,s.jsx)(n.code,{children:"@ManyToOne"})," secara default bersifat ",(0,s.jsx)(n.strong,{children:"EAGER"}),", pada kasus ini kita tidak perlu mengubahnya kecuali kita ingin menjadikannya ",(0,s.jsx)(n.strong,{children:"LAZY"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Entity\r\n@Table(name = "student")\r\npublic class Student {\r\n\r\n\t@Id\r\n\t@GeneratedValue(strategy = GenerationType.IDENTITY)\r\n\tprivate Integer id;\r\n\t\r\n\t@Column(name = "first_name")\r\n\tprivate String firstName;\r\n\t\r\n\t@Column(name = "last_name")\r\n\tprivate String lastName;\r\n\t\r\n\t@ManyToOne(cascade = {CascadeType.DETACH, CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})\r\n\t@JoinColumn(name = "class_id")\r\n\tprivate Classes classes;\r\n\t\r\n\t// Setter & Getter\r\n\r\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"3\ufe0f\u20e3-delete-parrent-classes",children:["3\ufe0f\u20e3 Delete Parrent ",(0,s.jsx)(n.code,{children:"Classes"})]}),"\n",(0,s.jsxs)(n.p,{children:["Pada contoh kasus ini kita akan menghapus data ",(0,s.jsx)(n.code,{children:"Classes"})," tanpa menghapus data dalam ",(0,s.jsx)(n.code,{children:"Student"})," yang terkait. Step-by-step delete data ",(0,s.jsx)(n.code,{children:"Classes"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Mencari ",(0,s.jsx)(n.strong,{children:"Classes"})," ID."]}),"\n",(0,s.jsxs)(n.li,{children:["Memutuskan hubungan dengan ",(0,s.jsx)(n.strong,{children:"Student"})," yang terkait dengan ",(0,s.jsx)(n.strong,{children:"Classes"})," tersebut."]}),"\n",(0,s.jsxs)(n.li,{children:["Menghapus ",(0,s.jsx)(n.strong,{children:"Classes"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-update-repository--dao",children:"\ud83d\udee2\ufe0f Update Repository / DAO"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Pada Implementasi DAO kita akan merubah ",(0,s.jsx)(n.code,{children:"deleteClassesById"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Repository\r\npublic class SchoolDAOImpl implements SchoolDAO {\r\n\r\n\tprivate EntityManager entityManager;\r\n\t\r\n\tpublic SchoolDAOImpl(EntityManager entityManager) {\r\n\t\tthis.entityManager = entityManager;\r\n\t}\r\n\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void deleteClassesById(Integer id) {\r\n\t\tClasses classes = entityManager.find(Classes.class, id);\r\n\t\tList<Student> students = classes.getStudents();\r\n\t\t\r\n\t\t// menghapus semua referensi Classes dalam data Student sebelum dihapus\r\n\t\tfor (Student student : students) {\r\n\t\t\tstudent.setClasses(null);\r\n\t\t}\r\n\t\t\r\n\t\t// hapus referensi objek terkait dan putuskan tautan bi-directiona\r\n\t\tclasses.getTeacher().setClasses(null);\r\n\t\t\t\t\r\n\t\tentityManager.remove(classes);\t\r\n\t}\r\n\r\n\t// Implementasi method Lainnya\r\n\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-main-class",children:"\u25b6\ufe0f Main Class"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Studi kasus kita memiliki data dalam database sbb:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\r\nmysql> select * from teacher;\r\n+----+------------+-----------+\r\n| id | first_name | last_name |\r\n+----+------------+-----------+\r\n|  1 | Inti       | Astuti    |\r\n|  2 | Hatake     | Kakashi   |\r\n|  3 | John       | Chena     |\r\n+----+------------+-----------+\r\n\r\nmysql> select * from classes;\r\n+----+------------+------------+\r\n| id | class_name | teacher_id |\r\n+----+------------+------------+\r\n|  2 | Kelas 12   |          1 |\r\n|  3 | Kelas 11   |          2 |\r\n|  5 | Kelas 10   |          3 |\r\n+----+------------+------------+\r\n\r\nmysql> select * from student;\r\n+----+------------+-----------+----------+\r\n| id | first_name | last_name | class_id |\r\n+----+------------+-----------+----------+\r\n|  1 | John       | Key       |        5 |\r\n|  2 | Abu        | Nawas     |        5 |\r\n|  4 | Indra      | Birowo    |        2 |\r\n|  5 | Ibnu       | Jamil     |        2 |\r\n|  6 | Tora       | Sudiro    |        2 |\r\n|  7 | Uzumaki    | Naruto    |        3 |\r\n|  8 | Uciha      | Sazuke    |        3 |\r\n|  9 | Rock       | Lee       |        3 |\r\n+----+------------+-----------+----------+\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Kita akan menghapus data ",(0,s.jsx)(n.code,{children:"Classes"})," dengan id 5, dan data pada ",(0,s.jsx)(n.code,{children:"Student"})," terkait ",(0,s.jsx)(n.strong,{children:"tidak ikut terhapus"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Pada main class application kita akan menghapus data ",(0,s.jsx)(n.code,{children:"Classes"})," yang memiliki id 5:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@SpringBootApplication\r\npublic class Application {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(Application.class, args);\r\n\t}\r\n\r\n\t// Bean ini akan dieksekusi di command line\r\n\t@Bean\r\n\tpublic CommandLineRunner commandLineRunner(SchoolDAO dao) {\r\n\t\treturn runner -> {\r\n\t\t\t\r\n\t\t\tdeleteClasses(dao);\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\r\n\tprivate void deleteClasses(SchoolDAO dao) {\r\n\t\tInteger id = 5;\r\n\t\tdao.deleteClassesById(id);\r\n\t\tSystem.out.println("Classes deleted with id " + id);\r\n\t}\r\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Output pada Hibernate SQL:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"Hibernate: select c1_0.id,c1_0.class_name,t1_0.id,t1_0.first_name,t1_0.last_name from classes c1_0 left join teacher t1_0 on t1_0.id=c1_0.teacher_id where c1_0.id=?\r\nHibernate: select s1_0.class_id,s1_0.id,s1_0.first_name,s1_0.last_name from student s1_0 where s1_0.class_id=?\r\nHibernate: update student set class_id=?,first_name=?,last_name=? where id=?\r\nHibernate: update student set class_id=?,first_name=?,last_name=? where id=?\r\nHibernate: delete from classes where id=?\r\nClasses deleted with id 5\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Cek perubahan dalam database, data ",(0,s.jsx)(n.code,{children:"Clases"})," dengan id 5 seharusnya sudah terhapus."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"mysql> select * from classes;\r\n+----+------------+------------+\r\n| id | class_name | teacher_id |\r\n+----+------------+------------+\r\n|  2 | Kelas 12   |          1 |\r\n|  3 | Kelas 11   |          2 |\r\n+----+------------+------------+\r\n\r\nmysql> select * from student;\r\n+----+------------+-----------+----------+\r\n| id | first_name | last_name | class_id |\r\n+----+------------+-----------+----------+\r\n|  1 | John       | Key       |     NULL |\r\n|  2 | Abu        | Nawas     |     NULL |\r\n|  4 | Indra      | Birowo    |        2 |\r\n|  5 | Ibnu       | Jamil     |        2 |\r\n|  6 | Tora       | Sudiro    |        2 |\r\n|  7 | Uzumaki    | Naruto    |        3 |\r\n|  8 | Uciha      | Sazuke    |        3 |\r\n|  9 | Rock       | Lee       |        3 |\r\n+----+------------+-----------+----------+\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"4\ufe0f\u20e3-delete-child-student",children:["4\ufe0f\u20e3 Delete Child ",(0,s.jsx)(n.code,{children:"Student"})]}),"\n",(0,s.jsxs)(n.p,{children:["Pada contoh kasus ini kita akan menghapus data ",(0,s.jsx)(n.code,{children:"Student"}),", tanpa menghapus data ",(0,s.jsx)(n.code,{children:"Classes"})," terkait."]}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-repository--dao",children:"\ud83d\udee2\ufe0f Repository / DAO"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Menambahkan method baru pada interface DAO dengan menambahkan method ",(0,s.jsx)(n.code,{children:"deleteStudentById"})," untuk menghandle menghapus data ",(0,s.jsx)(n.code,{children:"Student"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public interface SchoolDAO {\r\n\r\n\tvoid saveClasses(Classes classes);\r\n\t\r\n\tClasses findClassById(Integer id);\r\n\t\r\n\tvoid deleteClassesById(Integer id);\r\n\t\r\n\tTeacher findTeacherById(Integer id);\r\n\t\r\n\tvoid deleteTeacherById(Integer id);\r\n\t\r\n\tList<Student> findStudentByClassId(Integer id);\r\n\t\r\n\tClasses findClassesByIdJoinFetch(Integer id);\r\n\t\r\n\tvoid updateClasses(Classes classes);\r\n\t\r\n\tStudent findStudentById(Integer id);\r\n\t\r\n\tvoid updateStudent(Student student);\r\n\t\r\n\tvoid deleteStudentById(Integer id);\r\n\t\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implementasi DAO:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Repository\r\npublic class SchoolDAOImpl implements SchoolDAO {\r\n\r\n\tprivate EntityManager entityManager;\r\n\t\r\n\tpublic SchoolDAOImpl(EntityManager entityManager) {\r\n\t\tthis.entityManager = entityManager;\r\n\t}\r\n\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void deleteStudentById(Integer id) {\r\n\t\tentityManager.remove(entityManager.find(Student.class, id));\t\r\n\t}\r\n\r\n\t// Implementasi method Lainnya\r\n\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-main-class-1",children:"\u25b6\ufe0f Main Class"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Pada main class application kita akan menghapus data ",(0,s.jsx)(n.code,{children:"Student"})," yang memiliki id 5:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@SpringBootApplication\r\npublic class Application {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(Application.class, args);\r\n\t}\r\n\r\n\t// Bean ini akan dieksekusi di command line\r\n\t@Bean\r\n\tpublic CommandLineRunner commandLineRunner(SchoolDAO dao) {\r\n\t\treturn runner -> {\r\n\t\t\t\r\n\t\t\tdeleteStudent(dao);\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\r\n\tprivate void deleteStudent(SchoolDAO dao) {\r\n\t\tint id = 5;\r\n\t\tdao.deleteStudentById(id);\t\t\r\n\t}\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Output pada Hibernate SQL:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"Hibernate: select s1_0.id,c1_0.id,c1_0.class_name,t1_0.id,t1_0.first_name,t1_0.last_name,s1_0.first_name,s1_0.last_name from student s1_0 left join classes c1_0 on c1_0.id=s1_0.class_id left join teacher t1_0 on t1_0.id=c1_0.teacher_id where s1_0.id=?\r\nHibernate: delete from student where id=?\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Source Code"}),": ",(0,s.jsx)(n.a,{href:"https://github.com/TimposuLabs/belajar-springboot-jpa-hibernate-advance/tree/main/09-hibernate-one-to-many-delete",children:"https://github.com/TimposuLabs/belajar-springboot-jpa-hibernate-advance/tree/main/09-hibernate-one-to-many-delete"})]})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},89053(e,n,t){t.d(n,{A:()=>a});const a=t.p+"assets/images/one-to-many2-00fb2d0cbe6ed69f3fb5b85aae37a8e9.png"}}]);